<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BHOLA NATH BASAK</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:linear-gradient(to right, #1a2a6c, #b21f1f, #fdbb2d); color:white;}
header { text-align:center; padding:20px; background:rgba(0,0,0,0.6);}
header img { width:180px; height:180px; object-fit:cover; border-radius:50%; border:5px solid #fff;}
nav { display:flex; justify-content:center; background:rgba(0,0,0,0.8); flex-wrap:wrap;}
nav a, nav input[type=text] { color:white; text-decoration:none; padding:10px 15px; margin:5px; border-radius:5px; border:none;}
nav a:hover { background:#fbd46d; color:black;}
nav input[type=text] { width:200px; }
section { padding:20px; max-width:900px; margin:20px auto; background:rgba(255,255,255,0.1); border-radius:12px;}
h2 { color:#ffe66d;}
input, select { width:95%; padding:10px; margin:8px 0; border-radius:5px; border:none;}
button { padding:10px 20px; margin:10px 5px; border:none; border-radius:5px; cursor:pointer;}
button.submit-btn { background:#4CAF50; color:white;}
button.cancel-btn { background:#f44336; color:white;}
button.logout-btn { background:#ff6600; color:white; margin-top:10px;}
footer { text-align:center; padding:10px; font-size:14px; background:rgba(0,0,0,0.7); position:fixed; bottom:0; width:100%;}
footer a { color:#fbd46d; margin:0 8px; text-decoration:none; font-weight:bold;}
footer a:hover { color:white;}
table { width:100%; border-collapse: collapse; margin-top:15px;}
th,td { border:1px solid #fff; padding:8px; text-align:left;}
th { background: rgba(0,0,0,0.6);}
.status-pending { background:pink;}
.status-accepted { background:green; color:white;}
.status-rejected { background:red; color:white;}
.action-btn { padding:5px 10px; margin:2px; border-radius:5px; cursor:pointer; border:none;}
.action-accept { background:#aaa; color:white;}
.action-reject { background:#aaa; color:white;}
.action-delete { background:#555; color:white;}
.about-panel { background:linear-gradient(to right, #1e3c72, #2a5298); color:white; padding:15px; border-radius:12px; margin-bottom:20px;}
#dynamicForm { background:white; color:black; padding:20px; border-radius:12px; max-width:600px; margin:20px auto; display:none; border:2px solid red; }
#dynamicForm input, #dynamicForm select { width:95%; padding:8px; margin:6px 0; border-radius:5px; border:1px solid #ccc; color:black;}
#dynamicForm button { margin:5px; }
#visitorDetailsPanel { display:none; background:rgba(0,0,0,0.8); padding:20px; border-radius:12px; margin-top:20px; }
#visitorDetailsPanel h3 { color:#ffe66d; margin-top:15px; }
</style>
</head>
<body>

<header>
  <img src="myphoto.jpg" alt="BHOLA NATH BASAK">
  <h1>BHOLA NATH BASAK</h1>
</header>

<nav>
  <a href="#about">About Me</a>
  <a href="#" id="visitorLink">Visitor Form</a>
  <a href="#adminLogin">Admin Login</a>
  <input type="text" id="searchVisitor" placeholder="Search by Appointment No">
</nav>

<section id="about">
  <h2>About Me</h2>
  <div class="about-panel">
    <h3>Profile</h3>
    <p>I am BHOLA NATH BASAK, a dedicated professional with expertise in leadership and management...</p>
  </div>
</section>

<section id="dynamicForm">
  <h2>Visitor Appointment Form</h2>
  <form id="formVisitor">
    <label>Visitor Name</label>
    <input type="text" id="visitorName" required>
    <label>Father Name</label>
    <input type="text" id="fatherName" required>
    <label>Visitor DOB</label>
    <input type="date" id="dob" required>
    <label>Visitor Address</label>
    <input type="text" id="address" required>
    <label>Country</label>
    <select id="country" required>
      <option value="India (+91)">India (+91)</option>
      <option value="USA (+1)">USA (+1)</option>
      <option value="UK (+44)">UK (+44)</option>
      <option value="Canada (+1)">Canada (+1)</option>
      <option value="Australia (+61)">Australia (+61)</option>
      <option value="Germany (+49)">Germany (+49)</option>
      <option value="France (+33)">France (+33)</option>
      <option value="UAE (+971)">UAE (+971)</option>
      <option value="Saudi Arabia (+966)">Saudi Arabia (+966)</option>
      <option value="Other">Other</option>
    </select>
    <label>Visit Date</label>
    <input type="date" id="visitDate" required>
    <label>Visit Time</label>
    <input type="time" id="visitTime" required>
    <label>Contact Number</label>
    <input type="tel" id="contactNumber" required>
    <label>Passport Number</label>
    <input type="text" id="passport">
    <label>Email</label>
    <input type="email" id="email" required>
    <button type="submit" class="submit-btn">Submit</button>
    <button type="button" class="cancel-btn" onclick="document.getElementById('formVisitor').reset()">Cancel</button>
  </form>
</section>

<section id="adminLogin">
  <h2>Admin Login</h2>
  <form id="formAdmin">
    <label>Username</label>
    <input type="text" id="adminUsername" required>
    <label>Password</label>
    <input type="password" id="adminPassword" required>
    <button type="submit">Login</button>
  </form>
  <button id="logoutBtn" class="logout-btn" style="display:none;" onclick="logoutAdmin()">Logout</button>

  <div id="adminDashboard" style="display:none;">
    <h2>Visitor Details</h2>
    <table id="visitorTable">
      <thead>
        <tr>
          <th>Name</th><th>DOB</th><th>Father</th><th>Address</th>
          <th>Country</th><th>Visit Date</th><th>Visit Time</th>
          <th>Contact</th><th>Passport</th><th>Email</th>
          <th>Appointment</th><th>Status</th><th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div id="visitorDetailsPanel"></div>
  </div>
</section>

<footer>
  <span>Contact:</span>
  <a href="https://facebook.com/" target="_blank">Facebook</a>
  <a href="https://linkedin.com/" target="_blank">LinkedIn</a>
  <a href="https://instagram.com/" target="_blank">Instagram</a>
  <a href="mailto:starananda24@gmail.com">Email</a>
  <br>
  &copy; 2025 BHOLA NATH BASAK
</footer>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwx-A1wmW5-kdB5mn1SQFcbyF6PnSCpddfmMGAjbzgXZUzfQfmJMz6MHwkjrMdrCyNtRg/exec";

// Show dynamic visitor form
document.getElementById('visitorLink').onclick = function(){ 
  const form = document.getElementById('dynamicForm');
  form.style.display='block';
  form.scrollIntoView({behavior:'smooth'});
};

// Persist admin login
if(localStorage.getItem('adminLoggedIn')==='true'){
  document.getElementById('formAdmin').style.display='none';
  document.getElementById('logoutBtn').style.display='inline-block';
  document.getElementById('adminDashboard').style.display='block';
  loadVisitors();
}

// Visitor form submit
document.getElementById('formVisitor').onsubmit = async function(e){
  e.preventDefault();

  const dob = new Date(document.getElementById('dob').value);
  const visitDate = new Date(document.getElementById('visitDate').value);
  const visitTimeParts = document.getElementById('visitTime').value.split(':');
  const now = new Date();

  let age = now.getFullYear() - dob.getFullYear();
  const m = now.getMonth() - dob.getMonth();
  if(m<0 || (m===0 && now.getDate()<dob.getDate())) age--;
  if(age<18 || dob>now){ alert("DOB must be â‰¥18 and not future."); return; }

  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
  const visitDay = new Date(visitDate.getFullYear(), visitDate.getMonth(), visitDate.getDate());
  if(visitDay < today){ alert("Visit date cannot be in past."); return; }
  if(visitDay.getTime()===today.getTime()){
    const vh = parseInt(visitTimeParts[0]), vm=parseInt(visitTimeParts[1]);
    if(vh<now.getHours() || (vh===now.getHours() && vm<=now.getMinutes())){ alert("Visit time must be future."); return; }
  }

  let lastAppt = parseInt(localStorage.getItem('lastAppt')||0)+1;
  localStorage.setItem('lastAppt', lastAppt);
  const appointmentNumber = 'APMNTWBNBIND'+String(lastAppt).padStart(7,'0');

  const visitorData = {
    appointmentNumber,
    visitorName: document.getElementById('visitorName').value,
    fatherName: document.getElementById('fatherName').value,
    dob: document.getElementById('dob').value,
    address: document.getElementById('address').value,
    country: document.getElementById('country').value,
    visitDate: document.getElementById('visitDate').value,
    visitTime: document.getElementById('visitTime').value,
    contactNumber: document.getElementById('contactNumber').value,
    passport: document.getElementById('passport').value,
    email: document.getElementById('email').value
  };

  const response = await fetch(WEB_APP_URL,{method:'POST',body:JSON.stringify(visitorData)});
  const result = await response.json();
  if(result.success){
    // Print
    const printContent = `
Visitor Name: ${visitorData.visitorName}
Father Name: ${visitorData.fatherName}
DOB: ${visitorData.dob}
Address: ${visitorData.address}
Country: ${visitorData.country}
Visit Date: ${visitorData.visitDate}
Visit Time: ${visitorData.visitTime}
Contact: ${visitorData.contactNumber}
Passport: ${visitorData.passport}
Email: ${visitorData.email}
Appointment No: ${visitorData.appointmentNumber}
`;
    const newWin = window.open('');
    newWin.document.write('<pre>'+printContent+'</pre>');
    newWin.print();

    // WhatsApp
    window.open(`https://wa.me/?text=${encodeURIComponent(printContent)}`,'_blank');

    document.getElementById('formVisitor').reset();
    loadVisitors();
    alert("Form submitted! Appointment No: " + appointmentNumber);
  } else alert("Failed: "+result.error);
};

// Admin login
document.getElementById('formAdmin').onsubmit = async function(e){
  e.preventDefault();
  if(document.getElementById('adminUsername').value==='admin' && document.getElementById('adminPassword').value==='admin123'){
    localStorage.setItem('adminLoggedIn','true');
    document.getElementById('formAdmin').style.display='none';
    document.getElementById('logoutBtn').style.display='inline-block';
    document.getElementById('adminDashboard').style.display='block';
    loadVisitors();
  } else alert("Invalid credentials");
};

// Logout
function logoutAdmin(){
  localStorage.removeItem('adminLoggedIn');
  document.getElementById('adminDashboard').style.display='none';
  document.getElementById('formAdmin').style.display='block';
  document.getElementById('logoutBtn').style.display='none';
}

// Load visitors
async function loadVisitors(){
  try{
    const res = await fetch(WEB_APP_URL+"?action=getVisitors");
    const data = await res.json();
    const tbody = document.querySelector('#visitorTable tbody');
    tbody.innerHTML='';
    data.visitors.forEach(v=>{
      const dob = new Date(v['Visitor DOB']);
      const visitDate = new Date(v['Visit Date']);
      const visitTime = new Date('1970-01-01T'+v['Visit Time']+':00');
      const status = v['Status'] || 'Pending';
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${v['Visitor Name']}</td>
        <td>${dob.toLocaleDateString()}</td>
        <td>${v['Father Name']}</td>
        <td>${v['Visitor Address']}</td>
        <td>${v['Country']}</td>
        <td>${visitDate.toLocaleDateString()}</td>
        <td>${visitTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit', hour12:true})}</td>
        <td>${v['Contact Number']}</td>
        <td>${v['Passport Number']}</td>
        <td>${v['Email']}</td>
        <td>${v['Appointment Number']}</td>
        <td class="status-${status.toLowerCase()}">${status}</td>
        <td>
          <button class="action-btn action-accept" onclick="updateStatus('${v['Appointment Number']}','Accepted',this)" ${status==='Rejected'?'disabled':''}>Accept</button>
          <button class="action-btn action-reject" onclick="updateStatus('${v['Appointment Number']}','Rejected',this)" ${status==='Accepted'?'disabled':''}>Reject</button>
          <button class="action-btn action-delete" onclick="deleteVisitor('${v['Appointment Number']}',this)">Delete</button>
          <button class="action-btn" onclick="showDetails('${v['Appointment Number']}')">View Details</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
  } catch(err){ console.error(err); }
}

// Update Status
async function updateStatus(appt,status,btn){
  await fetch(WEB_APP_URL,{method:'POST',body:JSON.stringify({appointmentNumber:appt,status})});
  loadVisitors();
}

// Delete Visitor
async function deleteVisitor(appt,btn){
  if(confirm("Are you sure to delete this visitor?")){
    await fetch(WEB_APP_URL,{method:'POST',body:JSON.stringify({appointmentNumber:appt,delete:true})});
    loadVisitors();
    alert("Visitor Deleted");
  }
}

// Show Visitor Details
async function showDetails(appt){
  const res = await fetch(WEB_APP_URL+"?action=getVisitors");
  const data = await res.json();
  const visitor = data.visitors.find(v=>v['Appointment Number']===appt);
  if(!visitor) { alert("Visitor Deleted"); return; }

  const panel = document.getElementById('visitorDetailsPanel');
  panel.innerHTML = `
<h3>Education</h3>
<p>${visitor.visitorName} has pursued comprehensive education in various domains, blending theoretical knowledge and practical expertise, fostering critical thinking, analytical skills, and leadership abilities across diverse academic and professional settings. The educational journey emphasizes continuous learning, innovative thinking, and strategic problem-solving, equipping ${visitor.visitorName} to tackle real-world challenges with confidence and efficiency, maintaining a forward-thinking approach in all professional endeavors, ensuring sustained growth and development over time, and integrating knowledge effectively across multiple disciplines.</p>
<h3>Culture</h3>
<p>Growing up in diverse cultural settings, ${visitor.visitorName} embraces values such as respect, empathy, integrity, and collaboration. Exposure to multiple perspectives enriches personal and professional interactions, enhancing cross-cultural understanding, ethical decision-making, and inclusive practices. ${visitor.visitorName} values traditions while adopting modern approaches, balancing cultural heritage with contemporary insights, fostering teamwork, and nurturing positive organizational and community engagement.</p>
<h3>Personal Details</h3>
<p>${visitor.visitorName}, son/daughter of ${visitor['Father Name']}, resides at ${visitor['Visitor Address']}, ${visitor['Country']}. Born on ${new Date(visitor['Visitor DOB']).toLocaleDateString()}, ${visitor.visitorName} maintains active engagement in professional, social, and personal pursuits. ${visitor.visitorName} demonstrates discipline, responsibility, and a proactive mindset, contributing positively to any project or collaborative effort, prioritizing both personal growth and broader societal impact while pursuing continuous learning and skill enhancement.</p>
<h3>Hobbies</h3>
<p>${visitor.visitorName} enjoys a variety of hobbies, including creative writing, music, traveling, technology exploration, and community involvement. These activities foster imagination, cultural awareness, problem-solving, and resilience. Participation in hobbies helps ${visitor.visitorName} maintain balance between professional responsibilities and personal fulfillment, promoting holistic development and enriching experiences that inspire innovation and personal growth across multiple domains.</p>
<h3>Thoughts</h3>
<p>${visitor.visitorName} believes in innovation, ethical leadership, strategic thinking, and collaborative problem-solving. Emphasizing integrity, inclusivity, and continuous improvement, ${visitor.visitorName} approaches challenges holistically, balancing creativity with practicality, while fostering environments that encourage learning, innovation, and sustainable growth. Thoughts are guided by analytical reasoning, empathy, and long-term vision.</p>
<h3>Interests</h3>
<p>${visitor.visitorName} is actively interested in technology trends, leadership development, strategic planning, business innovation, and cross-cultural collaboration. ${visitor.visitorName} pursues continuous knowledge acquisition, networking, and skill enhancement, striving to contribute meaningfully to professional and societal growth, while exploring new opportunities, insights, and methodologies to stay ahead in dynamic environments and deliver measurable impact in chosen fields.</p>
`;
  panel.style.display='block';
  panel.scrollIntoView({behavior:'smooth'});
}

// Visitor search
document.getElementById('searchVisitor').oninput = function(){
  const search = this.value.trim().toLowerCase();
  const rows = document.querySelectorAll('#visitorTable tbody tr');
  rows.forEach(r=>{
    const appt = r.cells[10].innerText.toLowerCase();
    if(appt.includes(search)) r.style.display='table-row';
    else r.style.display='none';
  });
};

// Always scroll top on page load
window.onbeforeunload = function(){ window.scrollTo(0,0); };
</script>

</body>
</html>
