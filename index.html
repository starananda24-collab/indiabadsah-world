<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BHOLA NATH BASAK</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:linear-gradient(to right, #1a2a6c, #b21f1f, #fdbb2d); color:white;}
header { text-align:center; padding:20px; background:rgba(0,0,0,0.6);}
header img { width:180px; height:180px; object-fit:cover; border-radius:50%; border:5px solid #fff;}
nav { display:flex; justify-content:center; background:rgba(0,0,0,0.8); flex-wrap:wrap;}
nav a { color:white; text-decoration:none; padding:15px 20px;}
nav a:hover { background:#fbd46d; color:black; border-radius:5px;}
section { padding:20px; max-width:900px; margin:20px auto; background:rgba(255,255,255,0.1); border-radius:12px;}
h2 { color:#ffe66d;}
input, select { width:95%; padding:10px; margin:8px 0; border-radius:5px; border:none;}
button { padding:10px 20px; margin:10px 5px; border:none; border-radius:5px; cursor:pointer;}
button.submit-btn { background:#4CAF50; color:white;}
button.cancel-btn { background:#f44336; color:white;}
button.accept-btn { background:green; color:white; margin:0 2px;}
button.reject-btn { background:red; color:white; margin:0 2px;}
button.delete-btn { background:orange; color:white; margin:0 2px;}
footer { text-align:center; padding:10px; font-size:14px; background:rgba(0,0,0,0.7);}
footer a { color:#fbd46d; margin:0 8px; text-decoration:none; font-weight:bold;}
footer a:hover { color:white;}
table { width:100%; border-collapse: collapse; margin-top:15px;}
th,td { border:1px solid #fff; padding:8px; text-align:left;}
th { background: rgba(0,0,0,0.6);}
.status-pending { background:pink;}
.status-accepted { background:green; color:white;}
.status-rejected { background:red; color:white;}
.contact-links { display:flex; justify-content:center; gap:20px; margin-top:15px; }
.contact-links a { display:block; background:#4CAF50; color:white; padding:10px 15px; border-radius:8px; text-decoration:none; font-weight:bold;}
.contact-links a:hover { background:#45a049; }
#visitorFormSection { display:none; }
</style>
</head>
<body>

<header>
  <img src="myphoto.jpg" alt="BHOLA NATH BASAK">
  <h1>BHOLA NATH BASAK</h1>
</header>

<nav>
  <a href="#about">About Me</a>
  <a href="#" onclick="document.getElementById('visitorFormSection').style.display='block';">Visitor Form</a>
  <a href="#adminLogin">Admin Login</a>
</nav>

<section id="about">
  <h2>About Me</h2>
  <p style="background:white;color:#1a2a6c;padding:10px;border-radius:8px;">
  I am BHOLA NATH BASAK, born in Krishnagar, Nadia, India. My profile includes extensive experience in business management and leadership, combined with a passion for programming and technology. I strongly believe in continuous learning, creative thinking, and applying strategic planning to solve real-world problems. My hobbies include reading, traveling, and exploring new technologies. I am deeply inspired by culture and art, and I continuously seek knowledge to enhance both my professional and personal life. My educational background includes BA in Arts and MBA in Business Administration, which provided me with analytical and managerial skills. I actively engage in community services and volunteer work, focusing on social welfare and mentorship. I aim to create impactful projects that blend technology, creativity, and leadership. My interests include entrepreneurship, software development, and communication enhancement. I embrace challenges with determination and seek to inspire others to pursue excellence in their careers and personal development.
  </p>
</section>

<section id="visitorFormSection">
  <h2>Visitor Appointment Form</h2>
  <form id="formVisitor">
    <label>Visitor Name</label>
    <input type="text" id="visitorName" required>
    <label>Father Name</label>
    <input type="text" id="fatherName" required>
    <label>Visitor DOB</label>
    <input type="date" id="dob" required max="">
    <label>Visitor Address</label>
    <input type="text" id="address" required>
    <label>Country</label>
    <select id="country" required>
      <option value="India (+91)">India (+91)</option>
      <option value="USA (+1)">USA (+1)</option>
      <option value="UK (+44)">UK (+44)</option>
      <option value="Canada (+1)">Canada (+1)</option>
      <option value="Australia (+61)">Australia (+61)</option>
      <option value="Germany (+49)">Germany (+49)</option>
      <option value="France (+33)">France (+33)</option>
      <option value="UAE (+971)">UAE (+971)</option>
      <option value="Saudi Arabia (+966)">Saudi Arabia (+966)</option>
      <option value="Other">Other</option>
    </select>
    <label>Visit Date</label>
    <input type="date" id="visitDate" required min="">
    <label>Visit Time</label>
    <input type="time" id="visitTime" required>
    <label>Contact Number</label>
    <input type="tel" id="contactNumber" required>
    <label>Passport Number</label>
    <input type="text" id="passport">
    <label>Email</label>
    <input type="email" id="email" required>
    <button type="submit" class="submit-btn">Submit</button>
    <button type="button" class="cancel-btn" onclick="document.getElementById('formVisitor').reset()">Cancel</button>
  </form>
</section>

<section id="adminLogin">
  <h2>Admin Login</h2>
  <form id="formAdmin">
    <label>Username</label>
    <input type="text" id="adminUsername" required>
    <label>Password</label>
    <input type="password" id="adminPassword" required>
    <button type="submit">Login</button>
  </form>
  <button id="logoutBtn" style="display:none;" onclick="logoutAdmin()">Logout</button>
  <div id="adminDashboard" style="display:none;">
    <h2>Visitor Details</h2>
    <table id="visitorTable">
      <thead>
        <tr>
          <th>Appointment</th><th>Name</th><th>Father</th><th>DOB</th>
          <th>Address</th><th>Country</th><th>Visit Date</th><th>Visit Time</th>
          <th>Contact</th><th>Passport</th><th>Email</th><th>Status</th><th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</section>

<footer>
  <div class="contact-links">
    <a href="https://facebook.com/" target="_blank">Facebook</a>
    <a href="https://linkedin.com/" target="_blank">LinkedIn</a>
    <a href="https://instagram.com/" target="_blank">Instagram</a>
    <a href="mailto:starananda24@gmail.com" target="_blank">Email</a>
  </div>
  <p>Â© 2025 BHOLA NATH BASAK. All rights reserved.</p>
</footer>

<script>
// ----------------- Date limits -----------------
document.getElementById('dob').max = new Date().toISOString().split("T")[0];
document.getElementById('visitDate').min = new Date().toISOString().split("T")[0];

// ----------------- Admin Details -----------------
const admin = {
  username: "admin1",
  password: "Password123"
};
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbyuT7l2LNNJqxLDBfI0wMU58BhP7BSNwSpop-Ru22xII9uWdTS14UEOjMgHGuXKfcnRhw/exec";

// ----------------- Visitor Form Submit -----------------
document.getElementById('formVisitor').addEventListener('submit', function(e){
  e.preventDefault();
  const appointmentNo = 'APPT-' + Date.now();
  const visitorData = {
    appointmentNumber: appointmentNo,
    visitorName: document.getElementById('visitorName').value,
    fatherName: document.getElementById('fatherName').value,
    dob: document.getElementById('dob').value,
    address: document.getElementById('address').value,
    country: document.getElementById('country').value,
    visitDate: document.getElementById('visitDate').value,
    visitTime: document.getElementById('visitTime').value,
    contactNumber: document.getElementById('contactNumber').value,
    passport: document.getElementById('passport').value,
    email: document.getElementById('email').value
  };
  
  fetch(WEB_APP_URL, {
    method: "POST",
    body: JSON.stringify(visitorData)
  })
  .then(res=>res.json())
  .then(res=>{
    if(res.success){
      const waLink = `https://wa.me/+971506309833?text=${encodeURIComponent(
        `New Visitor Appointment:\nAppointment No: ${appointmentNo}\nName: ${visitorData.visitorName}\nFather: ${visitorData.fatherName}\nDOB: ${visitorData.dob}\nAddress: ${visitorData.address}\nCountry: ${visitorData.country}\nVisit Date: ${visitorData.visitDate}\nVisit Time: ${visitorData.visitTime}\nContact: ${visitorData.contactNumber}\nPassport: ${visitorData.passport}\nEmail: ${visitorData.email}`
      )}`;
      window.open(waLink,'_blank');

      const receiptContent = `<html><body>
      <h2>Visitor Appointment Receipt</h2>
      <p>Appointment No: ${appointmentNo}</p>
      <p>Name: ${visitorData.visitorName}</p>
      <p>Father Name: ${visitorData.fatherName}</p>
      <p>DOB: ${visitorData.dob}</p>
      <p>Address: ${visitorData.address}</p>
      <p>Country: ${visitorData.country}</p>
      <p>Visit Date: ${visitorData.visitDate}</p>
      <p>Visit Time: ${visitorData.visitTime}</p>
      <p>Contact: ${visitorData.contactNumber}</p>
      <p>Passport: ${visitorData.passport}</p>
      <p>Email: ${visitorData.email}</p>
      </body></html>`;
      const printWindow = window.open('', '', 'height=600,width=800');
      printWindow.document.write(receiptContent);
      printWindow.document.close();
      printWindow.print();

      document.getElementById('formVisitor').reset();
      alert(`Appointment Submitted!\nYour Appointment No: ${appointmentNo}`);
    } else alert("Failed to submit form");
  });
});

// ----------------- Admin Login -----------------
document.getElementById('formAdmin').addEventListener('submit', function(e){
  e.preventDefault();
  const username = document.getElementById('adminUsername').value;
  const password = document.getElementById('adminPassword').value;
  if(username===admin.username && password===admin.password){
    alert("Admin login successful");
    document.getElementById('formAdmin').style.display="none";
    document.getElementById('logoutBtn').style.display="inline-block";
    document.getElementById('adminDashboard').style.display="block";
    fetchAdminData();
  } else alert("Access denied");
});

// ----------------- Logout -----------------
function logoutAdmin(){
  document.getElementById('formAdmin').style.display="block";
  document.getElementById('logoutBtn').style.display="none";
  document.getElementById('adminDashboard').style.display="none";
}

// ----------------- Fetch Admin Data -----------------
function fetchAdminData(){
  fetch(WEB_APP_URL)
  .then(res=>res.json())
  .then(data=>{
    const tbody = document.getElementById('visitorTable').querySelector('tbody');
    tbody.innerHTML='';
    data.forEach(item=>{
      const tr=document.createElement('tr');
      tr.innerHTML=`
        <td>${item["Appointment Number"]||''}</td>
        <td>${item["Visitor Name"]||''}</td>
        <td>${item["Father Name"]||''}</td>
        <td>${item["Visitor DOB"]||''}</td>
        <td>${item["Visitor Address"]||''}</td>
        <td>${item["Country"]||''}</td>
        <td>${item["Visit Date"]||''}</td>
        <td>${item["Visit Time"]||''}</td>
        <td>${item["Contact Number"]||''}</td>
        <td>${item["Passport Number"]||''}</td>
        <td>${item["Email"]||''}</td>
        <td>${item.Status||'Pending'}</td>
        <td>
          <button class="accept-btn" onclick="changeStatus('${item['Appointment Number']}','accept',this)">Accept</button>
          <button class="reject-btn" onclick="changeStatus('${item['Appointment Number']}','reject',this)">Reject</button>
          <button class="delete-btn" onclick="deleteVisitor('${item['Appointment Number']}',this)">Delete</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
  });
}

// ----------------- Accept / Reject / Delete -----------------
function changeStatus(appointment,status,btn){
  btn.disabled=true;
  alert(`Appointment ${appointment} marked ${status}`);
  // Optional: send back-end status update to Google Sheet
}
function deleteVisitor(appointment,btn){
  btn.closest('tr').remove();
  alert(`Appointment ${appointment} deleted`);
  // Optional: send back-end delete to Google Sheet
}
</script>

</body>
</html>
