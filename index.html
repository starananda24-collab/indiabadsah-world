<script>
function submitVisitorForm() {
  const formData = {
    visitorName: document.getElementById("visitorName").value,
    dob: document.getElementById("visitorDOB").value,
    fatherName: document.getElementById("fatherName").value,
    address: document.getElementById("visitorAddress").value,
    country: document.getElementById("visitorCountry").value,
    visitDate: document.getElementById("visitDate").value,
    visitTime: document.getElementById("visitTime").value,
    contactNumber: document.getElementById("contactNumber").value,
    passport: document.getElementById("passportNumber").value,
    email: document.getElementById("email").value
  };

  fetch('https://script.google.com/macros/s/AKfycbzz3IXXuqEz9digVoHzUB1d2E-pOo2bACKZh44idgcgMuTmaieEJ_wHKTQ7j1Zkc8QnUg/exec', {
    method: 'POST',
    body: JSON.stringify(formData),
    headers: {
      'Content-Type': 'application/json'
    }
  })
  .then(response => response.json())
  .then(data => {
    alert(`${data.message}\nAppointment No: ${data.appointmentNo}`);
    closeVisitorForm(); // Close the form modal
  })
  .catch(error => {
    alert("Error submitting form: " + error.message);
  });
}
</script>
