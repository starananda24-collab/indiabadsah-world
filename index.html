<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visitor Form</title>
<style>
body { font-family: Arial, sans-serif; background: #f0f0f0; margin: 0; padding: 20px;}
section { background: white; padding: 20px; border-radius: 8px; max-width: 600px; margin:auto;}
input, select { width: 100%; padding: 10px; margin: 8px 0; border-radius: 5px; border:1px solid #ccc;}
button { padding: 10px 20px; border:none; border-radius:5px; background: #28a745; color:white; cursor:pointer;}
button:hover { background: #218838; }
#whatsappButton { display:block; padding:10px 15px; margin-top:10px; background:#25D366; color:white; text-decoration:none; border-radius:5px; text-align:center;}
#whatsappButton:hover { background:#128C7E; }
</style>
</head>
<body>

<section id="visitorFormSection">
<h2>Visitor Appointment Form</h2>
<form id="formVisitor">
    <label>Visitor Name</label>
    <input type="text" id="visitorName" required>
    
    <label>Visitor DOB</label>
    <input type="date" id="dob" required>
    
    <label>Father's Name</label>
    <input type="text" id="fatherName" required>
    
    <label>Address</label>
    <input type="text" id="address" required>
    
    <label>Country</label>
    <select id="country" required>
      <option>India (+91)</option>
      <option>USA (+1)</option>
      <option>UK (+44)</option>
      <option>UAE (+971)</option>
      <option>Other</option>
    </select>
    
    <label>Visit Date</label>
    <input type="date" id="visitDate" required>
    
    <label>Visit Time</label>
    <input type="time" id="visitTime" required>
    
    <label>Virtual Visit Purpose</label>
    <input type="text" id="purpose" required>
    
    <label>Contact Number</label>
    <input type="tel" id="contactNumber" required>
    
    <label>Passport Number (If Available)</label>
    <input type="text" id="passport">
    
    <label>Email ID</label>
    <input type="email" id="email" required>
    
    <button type="submit">Submit</button>
</form>
<a id="whatsappButton" href="#" target="_blank" style="display:none;">Send Submission to WhatsApp</a>
</section>

<script>
document.getElementById('dob').max = new Date().toISOString().split("T")[0];
document.getElementById('visitDate').min = new Date().toISOString().split("T")[0];

document.getElementById('formVisitor').addEventListener('submit', function(e){
  e.preventDefault();
  const appointmentNo = 'APPT-' + Date.now();
  const visitorData = {
    "Visitor Name": document.getElementById('visitorName').value,
    "Visitor DOB": document.getElementById('dob').value,
    "Father's Name": document.getElementById('fatherName').value,
    "Address": document.getElementById('address').value,
    "Country": document.getElementById('country').value,
    "Visit Date": document.getElementById('visitDate').value,
    "Visit Time": document.getElementById('visitTime').value,
    "Virtual Visit Purpose": document.getElementById('purpose').value,
    "Contact Number": document.getElementById('contactNumber').value,
    "Passport Number (If Available)": document.getElementById('passport').value,
    "Email ID": document.getElementById('email').value
  };

  google.script.run.withSuccessHandler(function(res){
    if(res.success){
      alert("Appointment submitted!\nAppointment No: " + appointmentNo);
      document.getElementById('formVisitor').reset();
      const waButton = document.getElementById('whatsappButton');
      const waLink = `https://wa.me/971506309833?text=${encodeURIComponent(
        `New Visitor Appointment:\nAppointment No: ${appointmentNo}\nName: ${visitorData["Visitor Name"]}\nContact: ${visitorData["Contact Number"]}\nVisit Date: ${visitorData["Visit Date"]} ${visitorData["Visit Time"]}\nPurpose: ${visitorData["Virtual Visit Purpose"]}`
      )}`;
      waButton.href = waLink;
      waButton.style.display = "block";
    } else {
      alert("Error: " + res.message);
    }
  }).submitVisitor(visitorData);
});
</script>

</body>
</html>
