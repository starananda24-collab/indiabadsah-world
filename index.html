<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BHOLA NATH BASAK</title>
<style>
  body { margin:0; font-family:Arial,sans-serif; background:linear-gradient(to right, #1a2a6c, #b21f1f, #fdbb2d); color:white;}
  header { text-align:center; padding:20px; background:rgba(0,0,0,0.6);}
  header img { width:180px; height:180px; object-fit:cover; border-radius:50%; border:5px solid #fff;}
  nav { display:flex; justify-content:center; background:rgba(0,0,0,0.8); flex-wrap:wrap; padding:8px;}
  nav a, nav input[type=text] { color:white; text-decoration:none; padding:10px 15px; margin:5px; border-radius:5px; border:none;}
  nav a:hover { background:#fbd46d; color:black;}
  nav input[type=text] { width:200px; color:black; padding:6px; border-radius:5px;}
  section { padding:20px; max-width:900px; margin:20px auto; background:rgba(255,255,255,0.1); border-radius:12px;}
  h2 { color:#ffe66d;}
  input, select { width:95%; padding:10px; margin:8px 0; border-radius:5px; border:none;}
  button { padding:10px 20px; margin:10px 5px; border:none; border-radius:5px; cursor:pointer;}
  button.submit-btn { background:#4CAF50; color:white;}
  button.cancel-btn { background:#f44336; color:white;}
  button.logout-btn { background:#ff6600; color:white; margin-top:10px;}
  footer { text-align:center; padding:10px; font-size:14px; background:rgba(0,0,0,0.7); position:fixed; bottom:0; width:100%;}
  footer a { color:#fbd46d; margin:0 8px; text-decoration:none; font-weight:bold;}
  footer a:hover { color:white;}
  table { width:100%; border-collapse: collapse; margin-top:15px;}
  th,td { border:1px solid #fff; padding:8px; text-align:left;}
  th { background: rgba(0,0,0,0.6);}
  .status-pending { background:pink;}
  .status-accepted { background:green; color:white;}
  .status-rejected { background:red; color:white;}
  .status-deleted { background:gray; color:white;}
  .action-btn { padding:5px 10px; margin:2px; border-radius:5px; cursor:pointer; border:none;}
  .action-accept { background:#aaa; color:white;}
  .action-reject { background:#aaa; color:white;}
  .action-delete { background:#555; color:white;}
  #dynamicForm { background:white; color:black; padding:20px; border-radius:12px; max-width:600px; margin:20px auto; display:none; border:2px solid red; }
  #dynamicForm input, #dynamicForm select { width:95%; padding:8px; margin:6px 0; border-radius:5px; border:1px solid #ccc; color:black;}
  #dynamicForm button { margin:5px; }
  .about-panel { background:linear-gradient(to right, #1e3c72, #2a5298); color:white; padding:15px; border-radius:12px; margin-bottom:20px; cursor:pointer;}
  .about-panel-content { display:none; color:white; margin-top:10px; line-height:1.6;}
  @media (max-width:720px){ nav{flex-direction:column;} nav input[type=text]{width:90%} }
</style>
</head>
<body>

<header>
  <img src="myphoto.jpg" alt="BHOLA NATH BASAK">
  <h1>BHOLA NATH BASAK</h1>
</header>

<nav>
  <a href="#about">About Me</a>
  <a href="#" id="visitorLink">Visitor Form</a>
  <a href="#adminLogin">Admin Login</a>
  <input type="text" id="searchVisitor" placeholder="Search by Appointment No">
</nav>

<section id="about">
  <h2>About Me</h2>

  <div class="about-panel" onclick="toggleAbout('personal')">Personal Details</div>
  <div id="personal" class="about-panel-content">
    <p>Born on 24th March 1988, I am married to Asha Basak since 2016 and blessed with a daughter, Sonakshi Basak, born on 29th November 2021 in Krishnagar. I prioritize integrity, discipline, and a growth mindset in every aspect of my life. My journey includes overcoming challenges through perseverance, maintaining strong family values, and contributing positively to my community. I am committed to lifelong learning, mentoring, and cultivating a balance between professional and personal life. Social responsibility and ethical conduct guide my decisions, while continuous self-improvement remains at the core of my personal philosophy.</p>
  </div>

  <div class="about-panel" onclick="toggleAbout('education')">Education</div>
  <div id="education" class="about-panel-content">
    <p>I completed a Bachelor of Arts followed by an MBA in Business Administration with a focus on strategic management, finance, and organizational behavior. Throughout my education, I engaged deeply in case studies, collaborative projects, and applied research to solve real-world business challenges. I emphasize evidence-based decision making, critical thinking, and innovative approaches in management practices. Continuous professional development and a commitment to learning have shaped my ability to contribute effectively to organizations, lead teams, and create measurable impact in business and community initiatives.</p>
  </div>

  <div class="about-panel" onclick="toggleAbout('culture')">Culture</div>
  <div id="culture" class="about-panel-content">
    <p>I value cultural diversity, inclusivity, and community engagement. Embracing different perspectives allows me to foster collaboration and implement socially responsible practices. I strive to bridge traditional values with modern innovation, encourage open communication, and promote ethical leadership. By participating in cross-cultural projects, community programs, and organizational initiatives, I ensure that culture remains central to sustainable growth and harmonious stakeholder relationships, enhancing both personal and professional environments.</p>
  </div>

  <div class="about-panel" onclick="toggleAbout('hobbies')">Hobbies</div>
  <div id="hobbies" class="about-panel-content">
    <p>My hobbies include reading, creative writing, listening to music, traveling, exploring technology, and mentoring young talents. These activities nurture creativity, resilience, and problem-solving skills while providing fresh perspectives and inspiration. Engaging in diverse hobbies helps maintain a balanced lifestyle, promotes mental well-being, and fuels professional growth by enhancing critical thinking, communication, and adaptive capabilities across various situations.</p>
  </div>

  <div class="about-panel" onclick="toggleAbout('thoughts')">Thoughts & Achievements</div>
  <div id="thoughts" class="about-panel-content">
    <p>I believe in ethical leadership, continuous improvement, and measurable impact. My achievements span process improvements, team mentoring, community development, and strategic project leadership. I consistently apply structured approaches to problem-solving and decision-making, focusing on tangible outcomes. Reflection, learning from experience, and goal-oriented action have enabled me to drive positive change while inspiring others to pursue excellence in both professional and personal spheres.</p>
  </div>

  <div class="about-panel" onclick="toggleAbout('interests')">Interests</div>
  <div id="interests" class="about-panel-content">
    <p>My interests include business analytics, organizational transformation, leadership development, cross-cultural collaboration, and lifelong learning. I actively apply these interests to enhance organizational effectiveness, encourage innovation, and develop sustainable practices. Engaging with diverse industries, networking with professionals, and staying informed about emerging trends allow me to contribute meaningfully to initiatives that foster growth, learning, and adaptive change in dynamic environments.</p>
  </div>
</section>

<section id="dynamicForm">
  <h2>Visitor Appointment Form</h2>
  <form id="formVisitor">
    <label>Visitor Name</label><input type="text" id="visitorName" required>
    <label>Father Name</label><input type="text" id="fatherName" required>
    <label>Visitor DOB</label><input type="date" id="dob" required>
    <label>Visitor Address</label><input type="text" id="address" required>
    <label>Country</label>
    <select id="country" required>
      <option value="India (+91)">India (+91)</option>
      <option value="UAE (+971)">UAE (+971)</option>
      <option value="USA (+1)">USA (+1)</option>
      <option value="UK (+44)">UK (+44)</option>
      <option value="Other">Other</option>
    </select>
    <label>Visit Date</label><input type="date" id="visitDate" required>
    <label>Visit Time</label><input type="time" id="visitTime" required>
    <label>Contact Number</label><input type="tel" id="contactNumber" required>
    <label>Passport Number</label><input type="text" id="passport">
    <label>Email</label><input type="email" id="email" required>
    <button type="submit" class="submit-btn">Submit</button>
    <button type="button" class="cancel-btn" id="cancelFormBtn">Cancel</button>
  </form>
</section>

<section id="adminLogin">
  <h2>Admin Login</h2>
  <form id="formAdmin">
    <label>Username</label><input type="text" id="adminUsername" required>
    <label>Password</label><input type="password" id="adminPassword" required>
    <button type="submit">Login</button>
  </form>
  <button id="logoutBtn" class="logout-btn" style="display:none;" onclick="logoutAdmin()">Logout</button>

  <div id="adminDashboard" style="display:none;">
    <h2>Visitor Details</h2>
    <table id="visitorTable">
      <thead>
        <tr>
          <th>Name</th><th>DOB</th><th>Father</th><th>Address</th>
          <th>Country</th><th>Visit Date</th><th>Visit Time</th>
          <th>Contact</th><th>Passport</th><th>Email</th>
          <th>Appointment</th><th>Status</th><th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</section>

<footer>
  BHOLA NATH BASAK | <a href="https://wa.me/971506309833">WhatsApp</a> | <a href="mailto:example@mail.com">Email</a>
</footer>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzXkLEwyDd9TTjPZfMQs_BkWuBoMCejo69Kfhi0blCn81SNb_tfQka0eBA1XlC9EHeFiA/exec";
const ADMIN_USER = "admin";
const ADMIN_PASS = "admin";

document.getElementById('visitorLink').addEventListener('click',()=>{document.getElementById('dynamicForm').style.display='block';});
document.getElementById('cancelFormBtn').addEventListener('click',()=>{document.getElementById('dynamicForm').style.display='none';});

function toggleAbout(id){const el=document.getElementById(id);el.style.display=(el.style.display==='block')?'none':'block';}

document.getElementById('formVisitor').addEventListener('submit', async function(e){
  e.preventDefault();
  const payload={
    "Visitor Name":document.getElementById('visitorName').value,
    "Father Name":document.getElementById('fatherName').value,
    "Visitor DOB":document.getElementById('dob').value,
    "Visitor Address":document.getElementById('address').value,
    "Country":document.getElementById('country').value,
    "Visit Date":document.getElementById('visitDate').value,
    "Visit Time":document.getElementById('visitTime').value,
    "Contact Number":document.getElementById('contactNumber').value,
    "Passport Number":document.getElementById('passport').value,
    "Email":document.getElementById('email').value
  };
  try{
    const resp=await fetch(WEB_APP_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
    const result=await resp.json();
    if(result.success){
      alert(`Appointment sent successfully.\nAppointment No: ${result.appointmentNumber}`);
      const now=new Date();
      const printContent=`====================================
          VISITOR APPOINTMENT
====================================
Name           : ${payload["Visitor Name"]}
Father Name    : ${payload["Father Name"]}
DOB            : ${payload["Visitor DOB"]}
Address        : ${payload["Visitor Address"]}
Country        : ${payload["Country"]}
Visit Date     : ${payload["Visit Date"]}
Visit Time     : ${payload["Visit Time"]}
Contact        : ${payload["Contact Number"]}
Passport       : ${payload["Passport Number"]}
Email          : ${payload["Email"]}
Appointment No : ${result.appointmentNumber}
Generated At   : ${now.toLocaleString()}
====================================`;
      const newWin=window.open('','Print','width=600,height=600');
      newWin.document.write('<pre style="font-family:monospace; font-size:16px;">'+printContent+'</pre>');
      newWin.print();
      window.open('https://wa.me/971506309833?text='+encodeURIComponent(printContent),'_blank');
      document.getElementById('formVisitor').reset();
      document.getElementById('dynamicForm').style.display='none';
    }
  }catch(err){console.error(err);alert('Error sending appointment. Please check your Web App URL and permissions.');}
});

document.getElementById('formAdmin').addEventListener('submit',function(e){
  e.preventDefault();
  const user=document.getElementById('adminUsername').value;
  const pass=document.getElementById('adminPassword').value;
  if(user===ADMIN_USER && pass===ADMIN_PASS){
    document.getElementById('adminDashboard').style.display='block';
    document.getElementById('logoutBtn').style.display='block';
    alert('Login Successful');
    loadVisitors();
  }else{alert('Invalid credentials');}
});

function logoutAdmin(){
  document.getElementById('adminDashboard').style.display='none';
  document.getElementById('logoutBtn').style.display='none';
  document.getElementById('formAdmin').reset();
}

async function loadVisitors(){
  const tbody=document.querySelector('#visitorTable tbody');
  tbody.innerHTML='';
  try{
    const resp=await fetch(WEB_APP_URL+'?action=getVisitors');
    const data=await resp.json();
    const visitors=Array.isArray(data.visitors)?data.visitors:[];
    visitors.forEach(v=>{
      const tr=document.createElement('tr');
      tr.innerHTML=`<td>${v["Visitor Name"]}</td>
        <td>${v["Visitor DOB"]}</td>
        <td>${v["Father Name"]}</td>
        <td>${v["Visitor Address"]}</td>
        <td>${v["Country"]}</td>
        <td>${v["Visit Date"]}</td>
        <td>${v["Visit Time"]}</td>
        <td>${v["Contact Number"]}</td>
        <td>${v["Passport Number"]}</td>
        <td>${v["Email"]}</td>
        <td>${v["Appointment Number"]}</td>
        <td class="status-${v.Status?.toLowerCase()||'pending'}">${v.Status||'Pending'}</td>
        <td>
          <button class="action-accept action-btn" onclick="updateStatus('${v['Appointment Number']}','Accepted')">Accept</button>
          <button class="action-reject action-btn" onclick="updateStatus('${v['Appointment Number']}','Rejected')">Reject</button>
          <button class="action-delete action-btn" onclick="deleteVisitor('${v['Appointment Number']}')">Delete</button>
        </td>`;
      tbody.appendChild(tr);
    });
  }catch(err){console.error(err);}
}

async function updateStatus(appNo,status){
  try{
    const resp=await fetch(WEB_APP_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({appointmentNumber:appNo,status})});
    const result=await resp.json();
    alert(result.message);
    loadVisitors();
  }catch(err){alert('Error updating status');}
}

async function deleteVisitor(appNo){
  if(!confirm("Do you want to delete this record permanently?")) return;
  try{
    const resp=await fetch(WEB_APP_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({appointmentNumber:appNo,delete:true})});
    const result=await resp.json();
    alert(result.message);
    loadVisitors();
  }catch(err){alert('Error deleting');}
}

document.getElementById('searchVisitor').addEventListener('keyup',function(){
  const filter=this.value.toLowerCase();
  const rows=document.querySelectorAll('#visitorTable tbody tr');
  rows.forEach(row=>{row.style.display=row.innerText.toLowerCase().includes(filter)?'':'none';});
});
</script>
</body>
</html>
