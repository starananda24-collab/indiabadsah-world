<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visitor Management</title>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f4f4f4; }
  header { background: #1E3A8A; color: #fff; padding: 20px; text-align: center; }
  .about-section { background: linear-gradient(135deg,#1E3A8A,#fff); color:#000; padding: 30px; margin:20px auto; max-width:900px; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.2);}
  .about-section h2 { text-align:center; margin-bottom:20px; }
  .about-section p { text-align:justify; line-height:1.6; margin-bottom:15px; }
  .visitor-btn { display:block; margin:20px auto; padding:15px 25px; background:#10B981; color:#fff; border:none; border-radius:5px; cursor:pointer; font-size:16px; }
  .visitor-form { display:none; background:#fff; padding:20px; max-width:500px; margin:0 auto 20px; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.2);}
  .visitor-form input, .visitor-form select { width:100%; padding:10px; margin:10px 0; border-radius:5px; border:1px solid #ccc; }
  .visitor-form button { padding:10px 20px; background:#1E3A8A; color:#fff; border:none; border-radius:5px; cursor:pointer; margin-right:10px; }
  .admin-section { background:#fff; padding:20px; max-width:1000px; margin:20px auto; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.2);}
  .admin-login { text-align:center; margin-bottom:20px; }
  .admin-login input { padding:10px; margin:5px; border-radius:5px; border:1px solid #ccc; }
  .admin-login button { padding:10px 20px; background:#10B981; color:#fff; border:none; border-radius:5px; cursor:pointer; }
  table { width:100%; border-collapse: collapse; margin-top:20px; }
  table, th, td { border:1px solid #ccc; }
  th, td { padding:10px; text-align:center; }
  th { background:#1E3A8A; color:#fff; }
  .action-btn { padding:5px 10px; margin:2px; border:none; border-radius:5px; cursor:pointer; color:#fff; }
  .accept { background:#10B981; }
  .reject { background:#EF4444; }
  .delete { background:#6B7280; }
  footer { background:#1E3A8A; color:#fff; text-align:center; padding:20px; margin-top:40px; }
  .contact-links { display:flex; justify-content:center; gap:15px; margin-top:10px; }
  .contact-links a { display:block; padding:10px 15px; border-radius:5px; text-decoration:none; color:#fff; background:linear-gradient(135deg,#10B981,#EC4899); }
</style>
</head>
<body>

<header>
  <h1>Visitor Management System</h1>
</header>

<section class="about-section">
  <h2>About Me</h2>
  <p><strong>Profile:</strong> Experienced professional with a diverse background in multiple domains, bringing expertise and innovation to every project. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur efficitur lorem in augue ultricies, a consectetur purus finibus. Proin ac neque vel justo pharetra ullamcorper. Sed vel efficitur erat. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</p>
  <p><strong>Thoughts:</strong> Committed to continuous learning and innovation. Fusce nec elit quis justo scelerisque fringilla non sit amet justo. Maecenas sit amet risus a purus imperdiet vehicula. Vivamus mollis elit vitae nisi vestibulum, in lacinia urna sollicitudin. Curabitur a velit vitae mi cursus tincidunt non a sapien.</p>
  <p><strong>Hobbies:</strong> Passionate about technology, reading, and creative pursuits. Praesent mollis sapien nec lectus imperdiet, vel feugiat neque dignissim. Nunc sit amet orci in nunc scelerisque convallis. Etiam vitae tellus feugiat, iaculis dolor nec, blandit purus. Donec dapibus magna ut metus fermentum malesuada.</p>
  <p><strong>Interests:</strong> Enthusiastic about problem-solving, innovation, and learning new skills. Integer vulputate urna id elit ultrices, ut mattis ex faucibus. Suspendisse potenti. Nullam tempor ligula vitae elit imperdiet, vel cursus magna vestibulum. Donec a ligula sed neque suscipit aliquet.</p>
  <p><strong>Culture:</strong> Advocate of collaboration, integrity, and ethical practices in all professional engagements. Sed in massa non magna volutpat tempor. Mauris sit amet lectus vitae nisi facilisis porttitor.</p>
  <p><strong>Education:</strong> Well-educated in diverse fields with continuous professional development. Vivamus id orci in elit hendrerit ultrices. Aliquam erat volutpat. Fusce vel felis nec mauris vehicula gravida. Curabitur sit amet dolor at erat eleifend luctus.</p>
</section>

<button class="visitor-btn" onclick="toggleVisitorForm()">Visitor Form</button>

<section class="visitor-form" id="visitorForm">
  <h2>Submit Visitor Form</h2>
  <input type="text" id="visitorName" placeholder="Visitor Name">
  <input type="date" id="dob" placeholder="Date of Birth">
  <input type="text" id="fatherName" placeholder="Father Name">
  <input type="text" id="address" placeholder="Address">
  <input type="text" id="country" placeholder="Country">
  <input type="date" id="visitDate" placeholder="Visit Date">
  <input type="time" id="visitTime" placeholder="Visit Time">
  <input type="text" id="contactNumber" placeholder="Contact Number">
  <input type="text" id="passport" placeholder="Passport Number">
  <input type="email" id="email" placeholder="Email">
  <button onclick="submitForm()">Submit</button>
  <button onclick="toggleVisitorForm()">Cancel</button>
</section>

<section class="admin-section">
  <div class="admin-login" id="adminLoginDiv">
    <input type="text" id="adminUser" placeholder="Admin Username">
    <input type="password" id="adminPass" placeholder="Password">
    <button onclick="adminLogin()">Login</button>
  </div>

  <div id="adminDashboard" style="display:none;">
    <button onclick="adminLogout()">Logout</button>
    <table id="visitorTable">
      <thead>
        <tr>
          <th>Timestamp</th>
          <th>Visitor Name</th>
          <th>DOB</th>
          <th>Father</th>
          <th>Address</th>
          <th>Country</th>
          <th>Visit Date</th>
          <th>Visit Time</th>
          <th>Contact</th>
          <th>Passport</th>
          <th>Email</th>
          <th>Appointment</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</section>

<footer>
  <p>&copy; 2025 Your Company. All rights reserved.</p>
  <div class="contact-links">
    <a href="https://facebook.com" target="_blank">Facebook</a>
    <a href="https://linkedin.com" target="_blank">LinkedIn</a>
    <a href="https://instagram.com" target="_blank">Instagram</a>
    <a href="mailto:example@gmail.com" target="_blank">Email</a>
  </div>
</footer>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw8-xvhH02BWCl9G8lYvqlkAqNNn0IxYXfwR9suNc81f0RJKjRi9kn48_tCKtAVh4UWYQ/exec";

function toggleVisitorForm(){
  const form = document.getElementById("visitorForm");
  form.style.display = (form.style.display==="block")?"none":"block";
}

function submitForm(){
  const data = {
    visitorName: document.getElementById("visitorName").value,
    dob: document.getElementById("dob").value,
    fatherName: document.getElementById("fatherName").value,
    address: document.getElementById("address").value,
    country: document.getElementById("country").value,
    visitDate: document.getElementById("visitDate").value,
    visitTime: document.getElementById("visitTime").value,
    contactNumber: document.getElementById("contactNumber").value,
    passport: document.getElementById("passport").value,
    email: document.getElementById("email").value,
    appointmentNumber: "APPT-" + new Date().getTime()
  };

  fetch(SCRIPT_URL, {
    method:"POST",
    body: JSON.stringify(data)
  }).then(r=>r.json()).then(res=>{
    if(res.success){
      alert("Form submitted! Appointment: "+data.appointmentNumber);
      window.open(`https://wa.me/917055484964?text=Visitor%20Name:%20${encodeURIComponent(data.visitorName)}%20Appointment:%20${encodeURIComponent(data.appointmentNumber)}`);
      toggleVisitorForm();
    }else{
      alert("Failed: "+res.error);
    }
  });
}

function adminLogin(){
  const user = document.getElementById("adminUser").value;
  const pass = document.getElementById("adminPass").value;
  if(user==="admin" && pass==="password123"){
    document.getElementById("adminLoginDiv").style.display="none";
    document.getElementById("adminDashboard").style.display="block";
    loadVisitors();
  }else{
    alert("Invalid credentials");
  }
}

function adminLogout(){
  document.getElementById("adminLoginDiv").style.display="block";
  document.getElementById("adminDashboard").style.display="none";
  document.getElementById("visitorTable").querySelector("tbody").innerHTML="";
}

function loadVisitors(){
  fetch(SCRIPT_URL+"?action=getVisitors")
  .then(r=>r.json())
  .then(res=>{
    if(res.success){
      const tbody = document.getElementById("visitorTable").querySelector("tbody");
      tbody.innerHTML="";
      res.visitors.forEach((v,i)=>{
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${v.Timestamp || ""}</td>
          <td>${v["Visitor Name"] || ""}</td>
          <td>${v["Visitor DOB"] || ""}</td>
          <td>${v["Father Name"] || ""}</td>
          <td>${v["Visitor Address"] || ""}</td>
          <td>${v.Country || ""}</td>
          <td>${v["Visit Date"] || ""}</td>
          <td>${v["Visit Time"] || ""}</td>
          <td>${v["Contact Number"] || ""}</td>
          <td>${v["Passport Number"] || ""}</td>
          <td>${v.Email || ""}</td>
          <td>${v["Appointment Number"] || ""}</td>
          <td>${v.Status || "Pending"}</td>
          <td>
            <button class="action-btn accept" onclick="updateStatus('${v['Appointment Number']}','Accept',this)">Accept</button>
            <button class="action-btn reject" onclick="updateStatus('${v['Appointment Number']}','Reject',this)">Reject</button>
            <button class="action-btn delete" onclick="deleteVisitor('${v['Appointment Number']}',this)">Delete</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }
  });
}

function updateStatus(appt,status,btn){
  const row = btn.parentElement.parentElement;
  const acceptBtn = row.querySelector(".accept");
  const rejectBtn = row.querySelector(".reject");
  if(status==="Accept"){
    acceptBtn.disabled=true;
    rejectBtn.disabled=false;
  } else if(status==="Reject"){
    acceptBtn.disabled=true;
    rejectBtn.disabled=true;
  }
  row.querySelector("td:nth-child(13)").innerText=status;
}

function deleteVisitor(appt,btn){
  const row = btn.parentElement.parentElement;
  row.remove();
}
</script>

</body>
</html>
