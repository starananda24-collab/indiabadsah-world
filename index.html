<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BHOLA NATH BASAK</title>
<style>
/* (kept your styles — unchanged except small layout spacing) */
body {margin:0; font-family: Arial, sans-serif; background:linear-gradient(to right,#1a2a6c,#b21f1f,#fdbb2d); color:white; line-height:1.6;}
header{text-align:center; padding:20px; background:rgba(0,0,0,0.6);}
header img{width:180px;height:180px;object-fit:cover;border-radius:50%;border:5px solid #fff;transition: transform 0.4s;}
header img:hover{transform: scale(1.05) rotate(2deg);}
header h1{margin:15px 0 0; font-size:2.5em;color:#fbd46d;text-shadow:2px 2px 5px black; font-family:'Arial Black', sans-serif;}
nav{display:flex;justify-content:center;background:rgba(0,0,0,0.8);flex-wrap:wrap;align-items:center;}
nav a{color:white;text-decoration:none;padding:10px 15px;display:block;transition:background 0.3s,color 0.3s;cursor:pointer;}
nav a:hover{background:#fbd46d;color:black;border-radius:5px;}
#statusSearch {margin-left:10px;padding:5px;border-radius:5px;border:none;}
#statusResult {margin-left:10px;}
section{padding:40px 20px;max-width:900px;margin:auto;background:rgba(255,255,255,0.1);margin-bottom:30px;border-radius:12px;box-shadow:0px 4px 15px rgba(0,0,0,0.5);}
section h2{color:#ffe66d;margin-bottom:15px;}
.form-box{background:rgba(0,0,0,0.7);padding:20px;border-radius:12px;color:white;max-width:500px;margin:auto;}
.form-box label{display:block;margin-bottom:10px;}
.form-box input, .form-box select, .form-box textarea{width:100%;padding:5px;margin-top:3px;border-radius:5px;border:none;}
.btn{background:#fbd46d;color:black;padding:8px 12px;border:none;border-radius:5px;cursor:pointer;margin-top:10px;}
.btn:hover{background:white;}
table{width:100%;border-collapse:collapse;color:black;background:white;margin-top:20px;}
table, th, td{border:1px solid #000;}
th, td{padding:8px;text-align:center;}
.green{background:#28a745;color:white;}
.red{background:#dc3545;color:white;}
.pink{background:#ff69b4;color:white;}
.hidden{display:none;}
.social-box{background:#333;padding:15px;margin:20px auto;border-radius:12px;max-width:400px;text-align:center;}
.social-box h3{margin-bottom:10px;color:#fbd46d;}
.social-box a{margin:0 10px;color:white;text-decoration:none;font-weight:bold;}
@media (max-width: 600px) {
  .form-box input, .form-box select, .form-box button, .form-box textarea {width:100% !important; font-size:16px; margin-top:5px;}
  nav {flex-direction: column; align-items: flex-start;}
  #statusSearch {width:90%; margin:10px;}
}
</style>
</head>
<body>

<header>
  <img src="myphoto.jpg" alt="Bhola Nath Basak Photo" />
  <h1>BHOLA NATH BASAK</h1>
</header>

<nav>
  <a onclick="showSection('profile')">Profile</a>
  <a onclick="showSection('education')">Education</a>
  <a onclick="showSection('culture')">Culture</a>
  <a onclick="showSection('achievements')">Achievements</a>
  <a onclick="showSection('hobbies')">Hobbies</a>
  <a onclick="showSection('interested')">Interested About</a>
  <a onclick="showSection('thoughts')">Thoughts</a>
  <a onclick="showSection('loverelation')">Love Relation</a>
  <a onclick="showSection('visitor')">Visitor Form</a>
  <a onclick="showSection('adminLogin')">Admin Login</a>
  <input id="statusSearch" type="text" placeholder="Visitor Status: Enter Appt No" onkeypress="if(event.key==='Enter'){checkStatus();}" />
</nav>

<div id="statusResult"></div>

<!-- Profile -->
<section id="profile">
  <h2>Profile</h2>
  <p style="font-family:'Arial Black', sans-serif; font-weight:bold; font-size:1.2em;">
    Personal Data: <br>
    Name: BHOLA NATH BASAK <br>
    Date of Birth: 24-03-1988 <br>
    Father's Name: <a href="#" onclick="showFatherInfo(event)">Late Sankar Lal Basak</a> <span id="fatherPopup" style="display:none;position:absolute;background:#fff;color:#000;padding:10px;border:1px solid #333;border-radius:8px;max-width:250px;z-index:1000;">Born in Krishnagar, Nadia, India, on 1934, 12th August - 16th June, 2016</span><br>
    Mother's Name: Anima Basak <br>
    Marriage: Love Marriage with Asha Basak, met July 2016, married September 2016 <br>
    Daughter: Sonaskhi Basak
  </p>
  <p>
    Bhola Nath Basak is a person whose life is an inspiring journey of passion, perseverance, and personal growth. From early childhood, he demonstrated an unquenchable curiosity about the world, fostering a love for learning that has guided every stage of his development. Growing up in a family that valued education and moral principles, he imbibed strong foundational values that shaped his character and interpersonal relationships. Through his experiences, Bhola has learned the importance of resilience, integrity, and consistent self-improvement. He believes in approaching every challenge as an opportunity to grow, and in encouraging others to recognize and realize their potential. His profile reflects a dedication not only to professional success but also to fostering meaningful connections and nurturing community values. Bhola’s personal philosophy intertwines ambition with compassion, aiming to balance personal achievements with contributing positively to society. His hobbies, interests, and cultural engagement further highlight his multidimensional personality, painting a comprehensive picture of a man committed to continuous learning, creativity, and inspiring others through actions as well as words. Over the years, he has developed a framework of discipline, empathy, and intellectual curiosity that guides his personal and professional decisions. Each accomplishment is viewed not only as a milestone but also as a stepping stone for future aspirations. Bhola’s journey embodies the principles of thoughtful reflection, proactive learning, and purposeful living. He has consistently sought to integrate traditional wisdom with modern innovation, emphasizing the importance of adaptability in a fast-evolving world. His relationships with family, friends, and colleagues reflect a deep commitment to honesty, loyalty, and respect. As an individual, he is driven by both the desire to achieve excellence and the aspiration to make a meaningful impact on those around him. This section captures the essence of Bhola’s character, highlighting a holistic view of his personal life, experiences, and guiding philosophy.
  </p>
</section>

<!-- Education -->
<section id="education">
  <h2>Education</h2>
  <p style="font-family:'Arial Black', sans-serif; font-weight:bold; font-size:1.2em;">
    Personal Data: <br>
    Name: BHOLA NATH BASAK <br>
    Date of Birth: 24-03-1988 <br>
    Father's Name: <a href="#" onclick="showFatherInfo(event)">Late Sankar Lal Basak</a><br>
    Mother's Name: Anima Basak <br>
    Marriage: Love Marriage with Asha Basak <br>
    Daughter: Sonaskhi Basak
  </p>
  <p>
    Education has played a pivotal role in shaping Bhola Nath Basak’s intellectual and personal development. From primary school to higher education, he has approached learning with a passion and discipline that underscore his lifelong commitment to knowledge acquisition. His academic journey was marked by curiosity, diligence, and an eagerness to engage deeply with diverse subjects. Whether in scientific inquiry, literary exploration, or social studies, Bhola sought to understand underlying principles and connect theoretical knowledge with practical application. Education for him is not merely a pursuit of degrees or certifications, but a comprehensive journey that includes the cultivation of critical thinking, problem-solving, creativity, and emotional intelligence. He actively participated in academic projects, seminars, and collaborative learning environments, enhancing not only his knowledge but also his communication and leadership skills. Beyond formal schooling, Bhola pursued self-directed learning, reading extensively across disciplines and engaging in continuous skill development. This approach has allowed him to adapt to changing circumstances, embrace new technologies, and remain relevant in an evolving global landscape. Bhola’s educational philosophy emphasizes holistic development—intellectual growth combined with ethical grounding, social awareness, and cultural sensitivity. He believes that true education equips individuals to make informed decisions, contribute meaningfully to society, and lead fulfilling lives. In every stage of his academic pursuit, he has sought opportunities to mentor peers, share insights, and cultivate a spirit of curiosity in others. Education has not only empowered him with knowledge but also instilled a sense of responsibility to apply that knowledge for the betterment of community and society at large. His achievements in education are reflected in both formal accolades and the intangible growth of wisdom, discipline, and perspective, making him a lifelong learner committed to continuous personal and professional development.
  </p>
</section>

<!-- Culture -->
<section id="culture">
  <h2>Culture</h2>
  <p style="font-family:'Arial Black', sans-serif; font-weight:bold; font-size:1.2em;">
    Personal Data: <br>
    Name: BHOLA NATH BASAK <br>
    Date of Birth: 24-03-1988 <br>
    Father's Name: <a href="#" onclick="showFatherInfo(event)">Late Sankar Lal Basak</a><br>
    Mother's Name: Anima Basak <br>
    Marriage: Love Marriage with Asha Basak <br>
    Daughter: Sonaskhi Basak
  </p>
  <p>
    Culture forms the core of Bhola Nath Basak’s worldview and daily practices. Rooted in traditions while embracing modernity, he understands culture as a living, evolving entity that shapes identity, values, and interpersonal relationships. His upbringing in a family that respected heritage instilled in him an appreciation for rituals, celebrations, and community cohesion. Simultaneously, exposure to global ideas and innovations has allowed him to blend traditional wisdom with contemporary perspectives. Bhola engages with cultural arts, literature, music, and festivals, seeing them as avenues to nurture creativity, emotional intelligence, and social cohesion. His approach to culture is inclusive and adaptive, recognizing the importance of diversity, empathy, and cross-cultural understanding in an interconnected world. Through participation in community events, mentoring younger generations, and promoting cultural awareness, he exemplifies how cultural engagement fosters personal growth and collective harmony. Bhola believes that cultural literacy extends beyond mere participation—it requires reflection, learning, and active contribution. By integrating lessons from heritage and experience, he continuously cultivates a balanced lifestyle that honors the past, thrives in the present, and inspires future innovation. The way he expresses himself—through attire, communication, celebrations, and civic engagement—demonstrates a harmonious alignment between personal values and cultural consciousness. Culture for Bhola is not static; it evolves with interaction, learning, and creativity, serving as a compass guiding ethical choices, artistic expression, and social responsibility. His life illustrates that culture, when embraced thoughtfully, becomes a source of identity, resilience, and inspiration, allowing him to connect meaningfully with diverse communities while fostering personal fulfillment.
  </p>
</section>

<!-- Achievements -->
<section id="achievements">
  <h2>Achievements</h2>
  <p style="font-family:'Arial Black', sans-serif; font-weight:bold; font-size:1.2em;">
    Personal Data: <br>
    Name: BHOLA NATH BASAK <br>
    Date of Birth: 24-03-1988 <br>
    Father's Name: <a href="#" onclick="showFatherInfo(event)">Late Sankar Lal Basak</a><br>
    Mother's Name: Anima Basak <br>
    Marriage: Love Marriage with Asha Basak <br>
    Daughter: Sonaskhi Basak
  </p>
  <p>
    Throughout his life, Bhola Nath Basak has achieved milestones that reflect dedication, perseverance, and a relentless pursuit of excellence. From academic successes to professional accomplishments, each achievement symbolizes the culmination of effort, learning, and resilience. Bhola values not only tangible recognition but also the intangible satisfaction derived from mastering new skills, overcoming challenges, and contributing meaningfully to his community. His accomplishments span personal growth, social engagement, professional development, and creative exploration, demonstrating a holistic approach to success. He approaches goals with strategic planning, discipline, and adaptability, recognizing that persistence in the face of obstacles is essential to achieving long-term objectives. Each award, certification, or recognition represents more than just external validation—it embodies lessons learned, experiences gained, and relationships nurtured along the journey. Bhola’s achievements also include fostering initiatives that benefit others, mentoring individuals, and supporting collaborative projects that have a lasting impact. He believes that true achievement encompasses ethical conduct, social contribution, and personal fulfillment, creating a legacy that inspires others. By maintaining a balance between ambition and empathy, Bhola ensures that his successes resonate not only within his personal sphere but also across communities he interacts with. This dedication to excellence, combined with humility and a growth mindset, allows him to continuously redefine goals, set new benchmarks, and remain committed to lifelong learning and meaningful contributions. His achievements exemplify a life lived with purpose, determination, and integrity.
  </p>
</section>

<!-- Hobbies -->
<section id="hobbies">
  <h2>Hobbies</h2>
  <p style="font-family:'Arial Black', sans-serif; font-weight:bold; font-size:1.2em;">
    Personal Data: <br>
    Name: BHOLA NATH BASAK <br>
    Date of Birth: 24-03-1988 <br>
    Father's Name: <a href="#" onclick="showFatherInfo(event)">Late Sankar Lal Basak</a><br>
    Mother's Name: Anima Basak <br>
    Marriage: Love Marriage with Asha Basak <br>
    Daughter: Sonaskhi Basak
  </p>
  <p>
    Bhola Nath Basak engages in a variety of hobbies that nourish his mind, body, and spirit. He enjoys reading, sports, music, technology, and artistic expression, all of which contribute to his well-rounded personality. Reading allows him to explore new ideas, enhance creativity, and develop critical thinking. Sports and physical activities maintain health, discipline, and teamwork skills. Music and art provide avenues for relaxation, emotional expression, and aesthetic appreciation. Technology fascinates him, offering endless opportunities to innovate and connect with global trends. Each hobby complements the other, creating a balance between mental stimulation, physical activity, and creative exploration. Through hobbies, Bhola cultivates focus, perseverance, and joy, fostering a harmonious lifestyle. His engagement in diverse recreational activities also strengthens social bonds, encourages lifelong learning, and provides inspiration for professional and personal growth. Hobbies are not merely leisure for Bhola—they are integral to his identity, creativity, and ongoing journey of self-discovery.
  </p>
</section>

<!-- Interested -->
<section id="interested">
  <h2>Interested About</h2>
  <p style="font-family:'Arial Black', sans-serif; font-weight:bold; font-size:1.2em;">
    Personal Data: <br>
    Name: BHOLA NATH BASAK <br>
    Date of Birth: 24-03-1988 <br>
    Father's Name: <a href="#" onclick="showFatherInfo(event)">Late Sankar Lal Basak</a><br>
    Mother's Name: Anima Basak <br>
    Marriage: Love Marriage with Asha Basak <br>
    Daughter: Sonaskhi Basak
  </p>
  <p>
    Bhola Nath Basak’s interests span leadership, innovation, culture, technology, and human development. He seeks to explore new ideas, understand global trends, and contribute to meaningful initiatives. His curiosity drives engagement in learning, networking, and problem-solving, fostering growth in personal and professional domains. By pursuing diverse interests, he nurtures creativity, strategic thinking, and adaptability. Bhola’s active exploration of cultural, technological, and leadership dimensions enables him to bridge knowledge and action, implementing insights in practical contexts. These interests align with his vision of continuous learning, collaboration, and creating value for communities. Through exploration and engagement, he cultivates a mindset open to possibilities, innovation, and personal fulfillment.
  </p>
</section>

<!-- Thoughts -->
<section id="thoughts">
  <h2>Thoughts</h2>
  <p style="font-family:'Arial Black', sans-serif; font-weight:bold; font-size:1.2em;">
    Personal Data: <br>
    Name: BHOLA NATH BASAK <br>
    Date of Birth: 24-03-1988 <br>
    Father's Name: <a href="#" onclick="showFatherInfo(event)">Late Sankar Lal Basak</a><br>
    Mother's Name: Anima Basak <br>
    Marriage: Love Marriage with Asha Basak <br>
    Daughter: Sonaskhi Basak
  </p>
  <p>
    Bhola Nath Basak believes in proactive, purposeful living. He views life as a canvas of opportunities, emphasizing integrity, determination, and empathy in every decision. His thoughts reflect reflection, strategic planning, and ethical judgment. Bhola often contemplates personal growth, social responsibility, and the balance between ambition and compassion. These guiding principles shape interactions, choices, and contributions to society, forming a philosophy rooted in resilience, curiosity, and meaningful engagement.
  </p>
</section>

<!-- Love Relation -->
<section id="loverelation">
  <h2>Love Relation</h2>
  <p style="font-family:'Arial Black', sans-serif; font-weight:bold; font-size:1.2em;">
    Personal Data: <br>
    Name: BHOLA NATH BASAK <br>
    Date of Birth: 24-03-1988 <br>
    Father's Name: <a href="#" onclick="showFatherInfo(event)">Late Sankar Lal Basak</a><br>
    Mother's Name: Anima Basak <br>
    Marriage: Love Marriage with Asha Basak, met July 2016, married September 2016 <br>
    Daughter: Sonaskhi Basak
  </p>
  <p>
    Bhola Nath Basak met Asha Basak in July 2016, and their connection was immediate and profound. Their love blossomed through mutual respect, shared values, and a deep understanding of each other’s aspirations. Within months, they chose to marry in September 2016, celebrating a partnership built on trust, affection, and commitment. Their relationship exemplifies harmony, mutual growth, and the joy of shared experiences. Together, they navigate life’s challenges, nurture their daughter Sonaskhi, and cultivate a family environment grounded in love, respect, and shared dreams. Their journey illustrates the power of connection, patience, and enduring commitment in personal relationships.
  </p>
</section>

<!-- Visitor Form (full-screen style) -->
<section id="visitor" class="hidden" style="background:#1a2a6c;padding:40px;">
  <h2>E_Appointment Visitor Form</h2>
  <form id="appointmentForm" class="form-box">
    <label>Name* <input id="Name" name="Name" type="text" required /></label>
    <label>Address <input id="Address" name="Address" type="text" /></label>
    <label>Date of Birth <input id="DateOfBirth" name="Date Of Birth" type="date" /></label>
    <label>Country <input id="Country" name="Country" type="text" /></label>
    <label>Father's Name <input id="FathersName" name="Father's Name" type="text" /></label>
    <label>Visit Date* <input id="VisitDate" name="Visit Date" type="date" required /></label>
    <label>Visit Time* <input id="VisitTime" name="Visit Time" type="time" required /></label>
    <label>Phone Number* <input id="PhoneNumber" name="Phone Number" type="tel" required /></label>
    <label>Email ID* <input id="EmailID" name="Email ID" type="email" required /></label>
    <label>Passport (If Available) <input id="Passport" name="Passport (If Available)" type="text" /></label>
    <label>Purpose <textarea id="Purpose" name="Purpose"></textarea></label>
    <div style="display:flex;gap:10px;flex-wrap:wrap;">
      <button type="submit" class="btn">Submit</button>
      <button type="button" class="btn" onclick="cancelVisitorForm()">Cancel</button>
    </div>
  </form>
  <div id="responseMessage" style="display:none;margin-top:10px;padding:10px;border-radius:5px;"></div>
</section>

<!-- Admin Login -->
<section id="adminLogin" class="hidden">
  <h2>Admin Login</h2>
  <div class="form-box">
    <label>Username <input id="adminUser" type="text" /></label>
    <label>Password <input id="adminPass" type="password" /></label>
    <button class="btn" onclick="adminLogin()">Login</button>
  </div>
</section>

<!-- Admin Dashboard -->
<section id="adminDashboard" class="hidden">
  <h2>Admin Dashboard</h2>
  <div style="margin-bottom:10px"><button class="btn" onclick="adminLogout()">Logout</button></div>
  <table id="visitorTable">
    <thead>
      <tr>
        <th>Appointment Number</th><th>Name</th><th>Address</th><th>Date Of Birth</th>
        <th>Country</th><th>Father's Name</th><th>Visit Date</th><th>Visit Time</th>
        <th>Phone Number</th><th>Email ID</th><th>Passport (If Available)</th><th>Purpose</th>
        <th>Status</th><th>Submitted</th><th>Actions</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

<!-- Communications -->
<div class="social-box">
  <h3>COMMUNICATIONS</h3>
  <a href="#" target="_blank">Facebook</a>
  <a href="#" target="_blank">Instagram</a>
  <a href="#" target="_blank">LinkedIn</a>
  <a href="tel:+1234567890">Phone</a>
</div>

<footer>
  <p>© 2025 BHOLA NATH BASAK | Personal Biography Website</p>
</footer>

<script>
/*
  FINAL: Full front-end logic.
  Replace SCRIPT_URL with your Apps Script web app URL if different.
*/
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxabjEMeIHXJiw8jDVINmPJ59FcdfP_q_6mAgD84aI4Umh1EAbyIqR1g72i0hCzNh-3/exec";

// Ensure initial view
showSection('profile');

// showSection safely defined before any clicks (function is global)
function showSection(id){
  document.querySelectorAll("section").forEach(s=>s.classList.add("hidden"));
  const el = document.getElementById(id);
  if(el) el.classList.remove("hidden");
  // scroll to top on section change
  window.scrollTo({top:0,behavior:'smooth'});
}

// Cancel visitor form: reset & go to home (profile)
function cancelVisitorForm(){
  document.getElementById('appointmentForm').reset();
  showSection('profile');
}

// Submit visitor form -> send to Apps Script with action=submit
document.getElementById("appointmentForm").addEventListener("submit", function(e){
  e.preventDefault();
  const form = e.target;
  const formData = new FormData(form);
  const params = new URLSearchParams();
  formData.forEach((v,k)=>params.append(k,v));
  params.append("action","submit");

  fetch(SCRIPT_URL, { method: "POST", body: params })
    .then(r=>r.json())
    .then(resp=>{
      const msg = document.getElementById("responseMessage");
      if(resp && resp.success){
        msg.innerHTML = "✅ Appointment submitted successfully. Your Appt No: <strong>" + resp.apptNo + "</strong>";
        msg.style.background = "#28a745";
        msg.style.color = "white";
        msg.style.display = "block";
        // Print the appointment details (print popup)
        printAppointmentPopup(resp);
        form.reset();
      } else {
        msg.innerHTML = "❌ Submission failed. Please try again.";
        msg.style.background = "#dc3545";
        msg.style.display = "block";
      }
    })
    .catch(err=>{
      const msg = document.getElementById("responseMessage");
      msg.innerHTML = "❌ Submission error: " + err.message;
      msg.style.background = "#dc3545";
      msg.style.display = "block";
    });
});

// Admin login (hardcoded credentials as before)
function adminLogin(){
  const u = document.getElementById("adminUser").value.trim();
  const p = document.getElementById("adminPass").value.trim();
  if(u === "admin" && p === "1234"){
    showSection('adminDashboard');
    loadVisitors();
  } else {
    alert("Invalid username or password");
  }
}
function adminLogout(){
  document.getElementById("adminUser").value = "";
  document.getElementById("adminPass").value = "";
  showSection('profile');
}

// Load visitors (GET main endpoint returns array)
function loadVisitors(){
  const tbody = document.querySelector("#visitorTable tbody");
  tbody.innerHTML = "<tr><td colspan='15'>Loading...</td></tr>";
  fetch(SCRIPT_URL)
    .then(r=>r.json())
    .then(data=>{
      tbody.innerHTML = "";
      if(!Array.isArray(data) || data.length === 0){
        tbody.innerHTML = "<tr><td colspan='15'>No visitors found.</td></tr>";
        return;
      }
      data.forEach(row => {
        let visitDateStr = row["Visit Date"] || "";
        let formattedVisitDate = visitDateStr;
        try {
          const d = new Date(visitDateStr);
          if(!isNaN(d)) formattedVisitDate = String(d.getDate()).padStart(2,'0') + "-" + String(d.getMonth()+1).padStart(2,'0') + "-" + d.getFullYear();
        } catch(e){}

        const tr = document.createElement('tr');
        tr.id = row["Appointment Number"];
        const statusClass = (row.Status === "Accepted" || row.Status === "Accept") ? "green" : (row.Status === "Rejected" || row.Status === "Reject") ? "red" : "pink";
        tr.className = statusClass;

        tr.innerHTML = `
          <td>${escapeHtml(row["Appointment Number"]||"")}</td>
          <td>${escapeHtml(row.Name||"")}</td>
          <td>${escapeHtml(row.Address||"")}</td>
          <td>${escapeHtml(row["Date Of Birth"]||"")}</td>
          <td>${escapeHtml(row.Country||"")}</td>
          <td>${escapeHtml(row["Father's Name"]||"")}</td>
          <td>${escapeHtml(formattedVisitDate)}</td>
          <td>${escapeHtml((row["Visit Time"]||"").slice(0,5))}</td>
          <td>${escapeHtml(row["Phone Number"]||"")}</td>
          <td>${escapeHtml(row["Email ID"]||"")}</td>
          <td>${escapeHtml(row["Passport (If Available)"]||"")}</td>
          <td>${escapeHtml(row.Purpose||"")}</td>
          <td>${escapeHtml(row.Status||"Pending")}</td>
          <td>${escapeHtml(row.Submitted||"")}</td>
          <td>
            <button class="btn accept-btn" onclick="changeStatusPersist('${encodeURIComponent(row['Appointment Number'])}','Accepted')" ${row.Status && row.Status !== "Pending" ? "disabled" : ""}>Accept</button>
            <button class="btn reject-btn" onclick="changeStatusPersist('${encodeURIComponent(row['Appointment Number'])}','Rejected')" ${row.Status && row.Status !== "Pending" ? "disabled" : ""}>Reject</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    });
}

// Visitor status check
function checkStatus(){
  const val = document.getElementById("statusSearch").value.trim();
  if(!val) return;
  fetch(`${SCRIPT_URL}?action=checkStatus&apptNo=${encodeURIComponent(val)}`)
    .then(r=>r.json())
    .then(resp=>{
      const div = document.getElementById("statusResult");
      if(resp && resp.Status){
        div.innerHTML = `Appointment No: ${val} Status: <strong>${resp.Status}</strong>`;
      } else div.innerHTML = "No appointment found for this number.";
    });
}

// Helper: change status and persist
function changeStatusPersist(appt,status){
  fetch(`${SCRIPT_URL}?action=updateStatus&apptNo=${appt}&status=${status}`)
    .then(r=>r.json())
    .then(resp=>loadVisitors())
    .catch(err=>alert("Error updating status: "+err.message));
}

// Escape html
function escapeHtml(text){if(!text) return ""; return text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");}

// Print popup
function printAppointmentPopup(data){
  const w = window.open("", "_blank", "width=600,height=400");
  w.document.write(`<h2>Appointment Confirmation</h2>
  <p>Appointment Number: ${data.apptNo}</p>
  <p>Name: ${escapeHtml(data.Name)}</p>
  <p>Visit Date: ${escapeHtml(data["Visit Date"])}</p>
  <p>Visit Time: ${escapeHtml(data["Visit Time"])}</p>
  <button onclick="window.print()">Print</button>`);
}

// Father info hover popup
function showFatherInfo(event){
  const popup = document.getElementById("fatherPopup");
  popup.style.display = "block";
  popup.style.left = event.pageX + 10 + "px";
  popup.style.top = event.pageY + 10 + "px";
  setTimeout(()=>{popup.style.display="none";},5000);
}
</script>

</body>
</html>
