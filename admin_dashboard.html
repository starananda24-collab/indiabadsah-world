<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard - INDIA BADSAH</title>
<style>
body { font-family: Arial,sans-serif; background: linear-gradient(to right,#1a2a6c,#b21f1f,#fdbb2d); color: #fff; margin:0; padding:0;}
header { background: rgba(0,0,0,0.7); padding:20px; text-align:center; position:relative;}
header h1 { margin:0;}
.logout-btn { position:absolute; right:20px; top:20px; padding:10px 20px; background:#fbd46d; color:black; border:none; border-radius:5px; cursor:pointer;}
.logout-btn:hover { background:#fff;}
table { width:95%; margin:20px auto; border-collapse: collapse; background: rgba(0,0,0,0.5);}
th, td { padding:10px; border:1px solid #fff; text-align:left;}
th { background: rgba(0,0,0,0.8);}
</style>
</head>
<body>

<header>
<h1>Admin Dashboard</h1>
<button class="logout-btn" onclick="adminLogout()">Logout</button>
</header>

<main>
<h2 style="text-align:center; margin-top:20px;">Visitor Appointments</h2>
<table id="visitorTable">
<thead>
<tr>
<th>Visitor Name</th>
<th>DOB</th>
<th>Father Name</th>
<th>Address</th>
<th>Country</th>
<th>Visit Date</th>
<th>Visit Time</th>
<th>Contact Number</th>
<th>Passport</th>
<th>Email</th>
<th>Appointment No</th>
<th>Timestamp</th>
</tr>
</thead>
<tbody>
<!-- Visitor data will be loaded here -->
</tbody>
</table>
</main>

<script>
const WEBAPP_URL="https://script.google.com/macros/s/AKfycbxTmCvsw2GY1Ceyx5yUAptHN0lAr6cs-DAPm71CtoiScCXpditZpKk653G7xkYNddCEYA/exec";

// Logout
function adminLogout(){
alert("You have been logged out.");
window.location.href="index.html";
}

// Load Visitor Data
function loadVisitorData(){
fetch(WEBAPP_URL)
.then(res=>res.json())
.then(data=>{
const tbody=document.getElementById('visitorTable').querySelector('tbody');
tbody.innerHTML='';
data.forEach(visitor=>{
const tr=document.createElement('tr');
tr.innerHTML=`
<td>${visitor['Visitor Name']}</td>
<td>${visitor['Visitor DOB']}</td>
<td>${visitor['Father Name']}</td>
<td>${visitor['Visitor Address']}</td>
<td>${visitor['Country']}</td>
<td>${visitor['Visit Date']}</td>
<td>${visitor['Visit Time']}</td>
<td>${visitor['Contact Number']}</td>
<td>${visitor['Passport Number']}</td>
<td>${visitor['Email']}</td>
<td>${visitor['Appointment Number']}</td>
<td>${visitor['Timestamp']}</td>
`;
tbody.appendChild(tr);
});
})
.catch(err=>alert("Error loading visitor data: "+err.message));
}

// Load data on page load
window.onload=loadVisitorData;
</script>

</body>
</html>
