<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BHOLA NATH BASAK</title>
<style>
body { margin:0; font-family:Arial,sans-serif; background:linear-gradient(to right, #1a2a6c, #b21f1f, #fdbb2d); color:white;}
header { text-align:center; padding:20px; background:rgba(0,0,0,0.6);}
header img { width:180px; height:180px; object-fit:cover; border-radius:50%; border:5px solid #fff;}
nav { display:flex; justify-content:center; background:rgba(0,0,0,0.8); flex-wrap:wrap; padding:8px;}
nav a, nav input[type=text] { color:white; text-decoration:none; padding:10px 15px; margin:5px; border-radius:5px; border:none;}
nav a:hover { background:#fbd46d; color:black;}
nav input[type=text] { width:200px; color:black; padding:6px; border-radius:5px;}
section { padding:20px; max-width:900px; margin:20px auto; background:rgba(255,255,255,0.1); border-radius:12px;}
h2 { color:#ffe66d;}
input, select { width:95%; padding:10px; margin:8px 0; border-radius:5px; border:none;}
button { padding:10px 20px; margin:10px 5px; border:none; border-radius:5px; cursor:pointer;}
button.submit-btn { background:#4CAF50; color:white;}
button.cancel-btn { background:#f44336; color:white;}
button.logout-btn { background:#ff6600; color:white; margin-top:10px;}
footer { text-align:center; padding:10px; font-size:14px; background:rgba(0,0,0,0.7); position:fixed; bottom:0; width:100%;}
footer a { color:#fbd46d; margin:0 8px; text-decoration:none; font-weight:bold;}
footer a:hover { color:white;}
table { width:100%; border-collapse: collapse; margin-top:15px;}
th,td { border:1px solid #fff; padding:8px; text-align:left;}
th { background: rgba(0,0,0,0.6);}
.status-pending { background:pink;}
.status-accepted { background:green; color:white;}
.status-rejected { background:red; color:white;}
.status-deleted { background:black; color:white;}
.action-btn { padding:5px 10px; margin:2px; border-radius:5px; cursor:pointer; border:none;}
.action-accept { background:#aaa; color:white;}
.action-reject { background:#aaa; color:white;}
.action-delete { background:#555; color:white;}
.about-panel { background:linear-gradient(to right, #1e3c72, #2a5298); color:white; padding:15px; border-radius:12px; margin-bottom:20px;}
#dynamicForm { background:white; color:black; padding:20px; border-radius:12px; max-width:600px; margin:20px auto; display:none; border:2px solid red; }
#dynamicForm input, #dynamicForm select { width:95%; padding:8px; margin:6px 0; border-radius:5px; border:1px solid #ccc; color:black;}
#dynamicForm button { margin:5px; }
.admin-details-panel { background: #cce7ff; color:black; padding:15px; border-radius:10px; margin-top:20px; cursor:pointer; border:1px solid #99d1ff;}
.admin-details-content { display:none; background:#e6f2ff; padding:15px; border-radius:10px; margin-top:10px; color:#001; line-height:1.5;}
#visitorDetailsPanel { display:none; background:rgba(0,0,0,0.8); padding:20px; border-radius:12px; margin-top:20px; }
#visitorDetailsPanel h3 { color:#ffe66d; margin-top:15px; }
@media (max-width:720px){ nav{flex-direction:column;} nav input[type=text]{width:90%} }
</style>
</head>
<body>

<header>
  <img src="myphoto.jpg" alt="BHOLA NATH BASAK">
  <h1>BHOLA NATH BASAK</h1>
</header>

<nav>
  <a href="#about">About Me</a>
  <a href="#" id="visitorLink">Visitor Form</a>
  <a href="#adminLogin">Admin Login</a>
  <input type="text" id="searchVisitor" placeholder="Search by Appointment No" aria-label="Search appointment (by number)">
</nav>

<section id="about">
<h2>About Me</h2>
<div class="about-panel">
<h3>Profile</h3>
<p>I am BHOLA NATH BASAK, a dedicated professional with expertise in leadership and management. My focus is on continuous development, strategic planning, and fostering growth for myself and others in diverse business environments.</p>

<div class="admin-details-panel" onclick="toggleDetails('personalDetails')">Personal Details (Click to expand)</div>
<div id="personalDetails" class="admin-details-content">
<p><strong>Date of Birth:</strong> 01-01-1980</p>
<p><strong>Place of Birth:</strong> Kolkata, India</p>
<p><strong>Father Name:</strong> Sankar Lal Basak</p>
<p><strong>Mother Name:</strong> Anima Basak</p>
<p>Upbringing and family values shaped professional choices emphasizing integrity, discipline, and lifelong learning.</p>
</div>

<div class="admin-details-panel" onclick="toggleDetails('education')">Education (Click to expand)</div>
<div id="education" class="admin-details-content">
<p>Bhola Nath Basak completed a Bachelor of Arts and MBA. Academic journey emphasized strategic management, finance, leadership, and team collaboration. Hands-on projects sharpened decision-making and analytical skills. Continuous learning ensures staying updated with industry trends.</p>
</div>

<div class="admin-details-panel" onclick="toggleDetails('culture')">Culture (Click to expand)</div>
<div id="culture" class="admin-details-content">
<p>Values cultural diversity, empathy, and ethical collaboration. Applies inclusive leadership to professional life, balancing tradition and innovation for socially responsible solutions.</p>
</div>

<div class="admin-details-panel" onclick="toggleDetails('hobbies')">Hobbies (Click to expand)</div>
<div id="hobbies" class="admin-details-content">
<p>Enjoys reading, writing, music, travel, technology exploration, and mentoring, fostering creativity, resilience, and critical thinking.</p>
</div>

<div class="admin-details-panel" onclick="toggleDetails('thoughts')">Thoughts & Achievements (Click to expand)</div>
<div id="thoughts" class="admin-details-content">
<p>Believes in ethical leadership and measurable impact. Achievements include process improvements, mentoring teams, and community contributions.</p>
</div>

<div class="admin-details-panel" onclick="toggleDetails('interests')">Interests (Click to expand)</div>
<div id="interests" class="admin-details-content">
<p>Interests: business analytics, leadership, organizational transformation, and cross-cultural collaboration.</p>
</div>
</div>
</section>

<section id="dynamicForm" style="display:none;">
<h2>Visitor Appointment Form</h2>
<form id="formVisitor">
<label>Visitor Name</label>
<input type="text" id="visitorName" required>
<label>Father Name</label>
<input type="text" id="fatherName" required>
<label>Visitor DOB</label>
<input type="date" id="dob" required>
<label>Visitor Address</label>
<input type="text" id="address" required>
<label>Country</label>
<select id="country" required>
<option value="India (+91)">India (+91)</option>
<option value="USA (+1)">USA (+1)</option>
<option value="UK (+44)">UK (+44)</option>
<option value="Canada (+1)">Canada (+1)</option>
<option value="Australia (+61)">Australia (+61)</option>
<option value="Germany (+49)">Germany (+49)</option>
<option value="France (+33)">France (+33)</option>
<option value="UAE (+971)">UAE (+971)</option>
<option value="Saudi Arabia (+966)">Saudi Arabia (+966)</option>
<option value="Other">Other</option>
</select>
<label>Visit Date</label>
<input type="date" id="visitDate" required>
<label>Visit Time</label>
<input type="time" id="visitTime" required>
<label>Contact Number</label>
<input type="tel" id="contactNumber" required>
<label>Passport Number</label>
<input type="text" id="passport">
<label>Email</label>
<input type="email" id="email" required>
<button type="submit" class="submit-btn">Submit</button>
<button type="button" class="cancel-btn" id="cancelFormBtn">Cancel</button>
</form>
</section>

<section id="adminLogin">
<h2>Admin Login</h2>
<form id="formAdmin">
<label>Username</label>
<input type="text" id="adminUsername" required>
<label>Password</label>
<input type="password" id="adminPassword" required>
<button type="submit">Login</button>
</form>
<button id="logoutBtn" class="logout-btn" style="display:none;" onclick="logoutAdmin()">Logout</button>

<div id="adminDashboard" style="display:none;">
<h2>Visitor Details</h2>
<table id="visitorTable">
<thead>
<tr>
<th>Name</th><th>DOB</th><th>Father</th><th>Address</th>
<th>Country</th><th>Visit Date</th><th>Visit Time</th>
<th>Contact</th><th>Passport</th><th>Email</th>
<th>Appointment</th><th>Status</th><th>Actions</th>
</tr>
</thead>
<tbody></tbody>
</table>
<div id="visitorDetailsPanel"></div>
</div>
</section>

<footer>
<span>Contact:</span>
<a href="https://facebook.com/" target="_blank">Facebook</a>
<a href="https://linkedin.com/" target="_blank">LinkedIn</a>
<a href="https://instagram.com/" target="_blank">Instagram</a>
<a href="mailto:starananda24@gmail.com">Email</a>
<br>&copy; 2025 BHOLA NATH BASAK
</footer>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwx-A1wmW5-kdB5mn1SQFcbyF6PnSCpddfmMGAjbzgXZUzfQfmJMz6MHwkjrMdrCyNtRg/exec";

function toggleDetails(id){
  const el=document.getElementById(id);
  el.style.display = el.style.display==='block'?'none':'block';
}

document.getElementById('visitorLink').addEventListener('click', e=>{
  e.preventDefault();
  const formSection=document.getElementById('dynamicForm');
  formSection.style.display='block';
  formSection.scrollIntoView({behavior:'smooth'});
  setTimeout(()=>document.getElementById('visitorName').focus(),300);
});

document.getElementById('cancelFormBtn').addEventListener('click', ()=>{
  document.getElementById('formVisitor').reset();
  document.getElementById('dynamicForm').style.display='none';
});

function generateAppointmentNumber(){
  let last=parseInt(localStorage.getItem('lastAppt')||'0',10);
  last++; localStorage.setItem('lastAppt',String(last));
  return 'APMNTWBNBIND'+String(last).padStart(7,'0');
}

document.getElementById('formVisitor').addEventListener('submit', async e=>{
  e.preventDefault();
  const name=document.getElementById('visitorName').value.trim();
  const father=document.getElementById('fatherName').value.trim();
  const dob=document.getElementById('dob').value;
  const address=document.getElementById('address').value.trim();
  const country=document.getElementById('country').value;
  const visitDate=document.getElementById('visitDate').value;
  const visitTime=document.getElementById('visitTime').value;
  const contact=document.getElementById('contactNumber').value.trim();
  const passport=document.getElementById('passport').value.trim();
  const email=document.getElementById('email').value.trim();

  const now=new Date();
  const dobDate=new Date(dob);
  if(isNaN(dobDate.getTime())){ alert('Please enter valid DOB'); return;}
  let age=now.getFullYear()-dobDate.getFullYear();
  const mm=now.getMonth()-dobDate.getMonth();
  if(mm<0||(mm===0 && now.getDate()<dobDate.getDate())) age--;
  if(age<18){ alert('Visitor must be at least 18'); return;}
  if(dobDate>now){ alert('DOB cannot be in the future'); return;}
  if(!visitDate){ alert('Please choose a visit date'); return;}
  if(!visitTime){ alert('Please choose a visit time'); return;}
  const visitDateObj=new Date(visitDate+'T'+visitTime+':00');
  if(isNaN(visitDateObj.getTime())||visitDateObj<now){ alert('Visit date/time must be in the future or later today'); return;}

  const appointmentNumber=generateAppointmentNumber();
  const payload={appointmentNumber, visitorName:name, fatherName:father, dob, address, country, visitDate, visitTime, contactNumber:contact, passport, email};

  alert('Appointment sent successfully');

  try{
    await fetch(WEB_APP_URL,{method:'POST',body:JSON.stringify(payload),headers:{'Content-Type':'application/json'}});
  }catch(err){ console.warn('Server submit failed.',err); }

  const printContent=`Visitor Name: ${name}\nFather Name: ${father}\nDOB: ${dob}\nAddress: ${address}\nCountry: ${country}\nVisit Date: ${visitDate}\nVisit Time: ${visitTime}\nContact: ${contact}\nPassport: ${passport}\nEmail: ${email}\nAppointment No: ${appointmentNumber}\n`;

  const w=window.open('','_blank');
  if(w){ w.document.write('<pre style="font-family:Arial;">'+printContent+'</pre>'); w.document.close(); w.focus(); w.print(); w.close(); }

  window.open('https://wa.me/?text='+encodeURIComponent(printContent),'_blank');
  document.getElementById('formVisitor').reset();
  document.getElementById('dynamicForm').style.display='none';
  await loadVisitors();
});

document.getElementById('formAdmin').addEventListener('submit', e=>{
  e.preventDefault();
  const user=document.getElementById('adminUsername').value;
  const pass=document.getElementById('adminPassword').value;
  if(user==='admin' && pass==='admin123'){
    localStorage.setItem('adminLoggedIn','true');
    document.getElementById('formAdmin').style.display='none';
    document.getElementById('logoutBtn').style.display='inline-block';
    document.getElementById('adminDashboard').style.display='block';
    loadVisitors();
  }else{ alert('Invalid credentials'); }
});

function logoutAdmin(){
  localStorage.removeItem('adminLoggedIn');
  document.getElementById('logoutBtn').style.display='none';
  document.getElementById('adminDashboard').style.display='none';
  document.getElementById('formAdmin').style.display='block';
}

async function loadVisitors(){
  if(localStorage.getItem('adminLoggedIn')!=='true') return;
  const tbody=document.querySelector('#visitorTable tbody'); tbody.innerHTML='';
  let visitors=[];
  try{
    const resp=await fetch(WEB_APP_URL+'?action=getVisitors');
    const data=await resp.json();
    visitors=Array.isArray(data.visitors)?data.visitors:[];
  }catch(err){ console.warn('Cannot fetch server, fallback to localStorage.',err); visitors=JSON.parse(localStorage.getItem('visitors')||'[]'); }
  populateVisitorRows(visitors);
}

function populateVisitorRows(visitors){
  const tbody=document.querySelector('#visitorTable tbody');
  tbody.innerHTML='';
  visitors.forEach(v=>{
    const status=v['Status']||v.status||'Pending';
    const tr=document.createElement('tr');
    const dobText=v['Visitor DOB']||v.dob||'';
    const visitDateText=v['Visit Date']||v.visitDate||'';
    const visitTimeText=v['Visit Time']||v.visitTime||'';
    tr.innerHTML=`
      <td>${escapeHtml(v['Visitor Name']||'')}</td>
      <td>${escapeHtml(dobText)}</td>
      <td>${escapeHtml(v['Father Name']||v.fatherName||'')}</td>
      <td>${escapeHtml(v['Visitor Address']||v.address||'')}</td>
      <td>${escapeHtml(v['Country']||v.country||'')}</td>
      <td>${escapeHtml(visitDateText)}</td>
      <td>${escapeHtml(visitTimeText)}</td>
      <td>${escapeHtml(v['Contact Number']||v.contactNumber||'')}</td>
      <td>${escapeHtml(v['Passport Number']||v.passport||'')}</td>
      <td>${escapeHtml(v['Email']||v.email||'')}</td>
      <td>${escapeHtml(v['Appointment Number']||v.appointmentNumber||'')}</td>
      <td class="status-${status.toLowerCase()}">${escapeHtml(status)}</td>
      <td>
        <button class="action-btn action-accept" ${status==='Rejected'?'disabled':''}>Accept</button>
        <button class="action-btn action-reject" ${status==='Accepted'?'disabled':''}>Reject</button>
        <button class="action-btn action-delete">Delete</button>
        <button class="action-btn" data-view>View Details</button>
      </td>
    `;
    const appt=v['Appointment Number']||v.appointmentNumber||'';
    tr.querySelector('.action-accept').addEventListener('click', async ()=>{ try{await fetch(WEB_APP_URL,{method:'POST',body:JSON.stringify({appointmentNumber:appt,status:'Accepted'})});}catch(e){console.warn(e);} await loadVisitors();});
    tr.querySelector('.action-reject').addEventListener('click', async ()=>{ try{await fetch(WEB_APP_URL,{method:'POST',body:JSON.stringify({appointmentNumber:appt,status:'Rejected'})});}catch(e){console.warn(e);} await loadVisitors();});
    tr.querySelector('.action-delete').addEventListener('click', async ()=>{
      if(!confirm('Are you sure to delete this visitor permanently?')) return;
      try{ await fetch(WEB_APP_URL,{method:'POST',body:JSON.stringify({appointmentNumber:appt,delete:true})}); }catch(e){console.warn(e);}
      await loadVisitors();
      alert('Visitor permanently deleted');
    });
    tr.querySelector('[data-view]').addEventListener('click', ()=>showDetails(appt));
    tbody.appendChild(tr);
  });
}

function escapeHtml(str){ if(!str) return ''; return String(str).replace(/[&<>"']/g,s=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[s]));}

async function showDetails(appt){
  let visitors=[];
  try{ const resp=await fetch(WEB_APP_URL+'?action=getVisitors'); const data=await resp.json(); visitors=Array.isArray(data.visitors)?data.visitors:[]; }catch(e){ visitors=JSON.parse(localStorage.getItem('visitors')||'[]'); }
  const v=visitors.find(x=>x['Appointment Number']===appt||x.appointmentNumber===appt);
  if(!v){ alert('Appointment Deleted'); return; }
  displayVisitorDetails(v);
}

function displayVisitorDetails(visitor){
  const panel=document.getElementById('visitorDetailsPanel');
  panel.innerHTML=`
<h3>Personal Details</h3>
<p><strong>Name:</strong> ${escapeHtml(visitor['Visitor Name']||visitor.visitorName||'')}</p>
<p><strong>Father:</strong> ${escapeHtml(visitor['Father Name']||visitor.fatherName||'')}</p>
<p><strong>DOB:</strong> ${escapeHtml(visitor['Visitor DOB']||visitor.dob||'')}</p>
<h3>Education</h3>
<p>Visitor engaged in learning and professional development across domains.</p>
<h3>Culture</h3>
<p>Visitor values cultural diversity, empathy, and collaborative practices.</p>
<h3>Hobbies</h3>
<p>Enjoys creative and learning activities that broaden perspective.</p>
<h3>Thoughts & Interests</h3>
<p>Interests include continuous learning, innovation and leadership development.</p>
`;
  panel.style.display='block'; panel.scrollIntoView({behavior:'smooth'});
}

document.getElementById('searchVisitor').addEventListener('input', function(){
  const value=this.value.trim().toLowerCase();
  document.querySelectorAll('#visitorTable tbody tr').forEach(r=>{
    const apptCell=r.cells[10];
    r.style.display=apptCell&&apptCell.innerText.trim().toLowerCase().includes(value)?'':'none';
  });
});

window.addEventListener('load', ()=>{
  window.scrollTo(0,0);
  if(localStorage.getItem('adminLoggedIn')==='true'){
    document.getElementById('formAdmin').style.display='none';
    document.getElementById('logoutBtn').style.display='inline-block';
    document.getElementById('adminDashboard').style.display='block';
    loadVisitors();
  }
});
window.onbeforeunload=function(){ window.scrollTo(0,0); };
</script>
</body>
</html>
