<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>INDIA BADSAH</title>
  <style>
    body { margin:0; font-family: Arial, sans-serif; background:linear-gradient(to right,#1a2a6c,#b21f1f,#fdbb2d); color:white; line-height:1.6; }
    header { text-align:center; padding:20px; background:rgba(0,0,0,0.6); }
    header img { width:180px; height:180px; object-fit:cover; border-radius:50%; border:5px solid #fff; transition: transform 0.4s; }
    header img:hover { transform: scale(1.05) rotate(2deg); }
    header h1 { margin:15px 0 0; font-size:2.5em; color:#fbd46d; text-shadow:2px 2px 5px black; }
    nav { display:flex; justify-content:center; background:rgba(0,0,0,0.8); flex-wrap:wrap; align-items:center; }
    nav a { color:white; text-decoration:none; padding:10px 15px; display:block; transition:background 0.3s,color 0.3s; cursor:pointer; }
    nav a:hover { background:#fbd46d; color:black; border-radius:5px; }
    #statusSearch { margin-left:10px; padding:5px; border-radius:5px; border:none; }
    #statusResult { margin-left:10px; }
    section { padding:40px 20px; max-width:900px; margin:auto; background:rgba(255,255,255,0.1); margin-bottom:30px; border-radius:12px; box-shadow:0px 4px 15px rgba(0,0,0,0.5); }
    section h2 { color:#ffe66d; margin-bottom:15px; }
    .form-box { background:rgba(0,0,0,0.7); padding:20px; border-radius:12px; color:white; max-width:500px; margin:auto; }
    .form-box label { display:block; margin-bottom:10px; }
    .form-box input, .form-box select { width:100%; padding:5px; margin-top:3px; border-radius:5px; border:none; }
    .btn { background:#fbd46d; color:black; padding:8px 12px; border:none; border-radius:5px; cursor:pointer; margin-top:10px; }
    .btn:hover { background:white; }
    table { width:100%; border-collapse:collapse; color:black; background:white; margin-top:20px; }
    table, th, td { border:1px solid #000; }
    th, td { padding:8px; text-align:center; }
    .green { background:#28a745; color:white; }
    .red { background:#dc3545; color:white; }
    .pink { background:#ff69b4; color:white; }
    .hidden { display:none; }
    @media (max-width: 600px) {
      .form-box input, .form-box select, .form-box button { width:100% !important; font-size:16px; margin-top:5px; }
      nav { flex-direction: column; align-items: flex-start; }
      #statusSearch { width:90%; margin:10px; }
    }
  </style>
</head>
<body>

<header>
  <img src="myphoto.jpg" alt="India Badsah Photo">
  <h1>INDIA BADSAH</h1>
</header>

<nav>
  <a onclick="showSection('profile')">Profile</a>
  <a onclick="showSection('education')">Education</a>
  <a onclick="showSection('culture')">Culture</a>
  <a onclick="showSection('achievements')">Achievements</a>
  <a onclick="showSection('hobbies')">Hobbies</a>
  <a onclick="showSection('interested')">Interested About</a>
  <a onclick="showSection('thoughts')">Thoughts</a>
  <a onclick="showSection('visitor')">Visitor Form</a>
  <a onclick="showSection('adminLogin')">Admin Login</a>
  <input type="text" id="statusSearch" placeholder="Visitor Status: Enter Appt No" onkeypress="if(event.key==='Enter'){checkStatus();}">
</nav>
<div id="statusResult"></div>

<section id="profile"><h2>Profile</h2><p>I am INDIA BADSAH, a passionate learner and explorer.</p></section>
<section id="education"><h2>Education</h2><p>Details here about education.</p></section>
<section id="culture"><h2>Culture</h2><p>Your culture content here.</p></section>
<section id="achievements"><h2>Achievements</h2><p>Your achievements here.</p></section>
<section id="hobbies"><h2>Hobbies</h2><p>Your hobbies here.</p></section>
<section id="interested"><h2>Interested About</h2><p>What you are interested in.</p></section>
<section id="thoughts"><h2>Thoughts</h2><p>Your thoughts here.</p></section>

<section id="visitor" class="hidden">
  <h2>E_Appointment Visitor Form</h2>
  <form id="appointmentForm" class="form-box">
    <label>Visitor Name* <input type="text" id="vname" required></label>
    <label>Visitor Address <input type="text" id="vaddress"></label>
    <label>From Country <input type="text" id="vcountry"></label>
    <label>Date of Birth <input type="date" id="vdob"></label>
    <label>Virtual Visit Date* <input type="date" id="vdate" required></label>
    <label>Time Availability* <input type="time" id="vtime" required></label>
    <label>Contact Number* <input type="tel" id="vphone" required></label>
    <label>Purpose of Visit
      <select id="vpurpose">
        <option value="Visit Abroad">Visit Abroad</option>
        <option value="Student Visa in Abroad">Student Visa in Abroad</option>
        <option value="Job in Abroad">Job in Abroad</option>
        <option value="Education system in Abroad">Education system in Abroad</option>
      </select>
    </label>
    <label>Email ID <input type="email" id="vemail"></label>
    <button type="submit" class="btn">Submit</button>
  </form>
</section>

<section id="adminLogin" class="hidden">
  <h2>Admin Login</h2>
  <div class="form-box">
    <label>Username <input type="text" id="adminUser"></label>
    <label>Password <input type="password" id="adminPass"></label>
    <button onclick="adminLogin()" class="btn">Login</button>
  </div>
</section>

<section id="adminDashboard" class="hidden">
  <h2>Admin Dashboard</h2>
  <button onclick="adminLogout()" class="btn">Logout</button>
  <table id="visitorTable">
    <thead><tr>
      <th>Appt No</th><th>Name</th><th>Date</th><th>Time</th><th>Contact</th><th>Purpose</th><th>Status</th><th>Action</th>
    </tr></thead>
    <tbody></tbody>
  </table>
</section>

<footer>
  <p>© 2025 INDIA BADSAH | Personal Biography Website</p>
</footer>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbw3pUVT75NCqxWEQAv2W-UoMKuQOd8fbaETnfncs7GrgPISVeNyT1OMJFT6YgO3Zst0Qw/exec";

// Utility: show section
function showSection(id){
  document.querySelectorAll("section").forEach(s=>s.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

// Visitor form submit
document.getElementById("appointmentForm").addEventListener("submit", async function(e){
  e.preventDefault();
  let formData = {
    name: document.getElementById("vname").value.trim(),
    address: document.getElementById("vaddress").value.trim(),
    country: document.getElementById("vcountry").value.trim(),
    dob: document.getElementById("vdob").value,
    date: document.getElementById("vdate").value,
    time: document.getElementById("vtime").value,
    contact: document.getElementById("vphone").value.trim(),
    purpose: document.getElementById("vpurpose").value,
    email: document.getElementById("vemail").value.trim()
  };
  try {
    let resp = await fetch(WEB_APP_URL, {
      method: "POST",
      body: JSON.stringify(formData),
      headers: { "Content-Type": "application/json" }
    });
    let result = await resp.json();
    if(result.success){
      alert("Appointment submitted! Your No: " + result.appointmentNo);
      document.getElementById("appointmentForm").reset();
    } else {
      alert("Error: " + result.error);
    }
  } catch(err) {
    alert("Error submitting form: " + err);
  }
});

// Check visitor status
async function checkStatus(){
  let apptNo = document.getElementById("statusSearch").value.trim();
  if(!apptNo){
    alert("Enter appointment number");
    return;
  }
  try {
    let resp = await fetch(WEB_APP_URL + "?action=status&apptNo=" + encodeURIComponent(apptNo));
    let data = await resp.json();
    if(data.success && data.record){
      let v = data.record;
      let color = v.Status === "Accepted" ? "green" : v.Status === "Rejected" ? "red" : "pink";
      document.getElementById("statusResult").innerHTML = `
        <div style="padding:15px;background:white;color:black;border-radius:8px;">
          <p><strong>Appt No:</strong> ${apptNo}</p>
          <p><strong>Name:</strong> ${v.Name}</p>
          <p><strong>Status:</strong> <button class="${color}">${v.Status}</button></p>
        </div>`;
    } else {
      document.getElementById("statusResult").innerHTML = "❌ Appointment not found";
    }
  } catch(err){
    alert("Error fetching status: " + err);
  }
}

// Admin login & dashboard
async function adminLogin(){
  let u = document.getElementById("adminUser").value;
  let p = document.getElementById("adminPass").value;
  if(u === "admin" && p === "admin"){
    showSection("adminDashboard");
    await loadAdminTable();
  } else {
    alert("Invalid Credentials");
  }
}
function adminLogout(){
  showSection("profile");
}

// Load admin table
async function loadAdminTable(){
  try {
    let resp = await fetch(WEB_APP_URL + "?action=all");
    let data = await resp.json();
    if(data.success){
      let rows = data.data; // array of records
      let tbody = document.querySelector("#visitorTable tbody");
      tbody.innerHTML = "";
      rows.forEach(record => {
        let colorClass = record.Status === "Accepted" ? "green" : record.Status === "Rejected" ? "red" : "pink";
        let tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${record["Appointment No"]}</td>
          <td>${record["Name"]}</td>
          <td>${record["Date"]}</td>
          <td>${record["Time"]}</td>
          <td>${record["Contact"]}</td>
          <td>${record["Purpose"]}</td>
          <td><button class="${colorClass}">${record["Status"]}</button></td>
          <td>
            <button onclick="updateStatus('${record["Appointment No"]}', 'Accepted')" ${record["Status"] !== "Pending" ? "disabled" : ""}>Accept</button>
            <button onclick="updateStatus('${record["Appointment No"]}', 'Rejected')" ${record["Status"] !== "Pending" ? "disabled" : ""}>Reject</button>
          </td>`;
        tbody.appendChild(tr);
      });
    } else {
      alert("Error loading data: " + data.error);
    }
  } catch(err){
    alert("Error loading table: " + err);
  }
}

// Update status by admin
async function updateStatus(apptNo, newStatus){
  try {
    let resp = await fetch(WEB_APP_URL, {
      method: "POST",
      body: JSON.stringify({ appointmentNo: apptNo, status: newStatus }),
      headers: { "Content-Type": "application/json" }
    });
    let result = await resp.json();
    if(result.success){
      await loadAdminTable();
    } else {
      alert("Error updating status: " + result.error);
    }
  } catch(err){
    alert("Error updating status: " + err);
  }
}
</script>
</body>
</html>
