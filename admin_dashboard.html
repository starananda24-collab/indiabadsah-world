<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard</title>
<style>
body {
    margin:0;
    font-family: Arial, sans-serif;
    background: linear-gradient(to right, #1a2a6c, #b21f1f, #fdbb2d);
    color: white;
}
header {
    background: rgba(0,0,0,0.7);
    padding: 20px;
    text-align: center;
}
header h1 {
    margin:0;
    font-size:2em;
    color: #fbd46d;
}
button#logout {
    padding: 10px 20px;
    border:none;
    border-radius:5px;
    background:#fbd46d;
    color:black;
    font-weight:bold;
    cursor:pointer;
    float:right;
    margin-top:-40px;
    margin-right:20px;
}
button#logout:hover {background:#ffe66d;}
table {
    width: 95%;
    margin:20px auto;
    border-collapse: collapse;
    background: rgba(0,0,0,0.5);
    border-radius: 10px;
    overflow:hidden;
}
table th, table td {
    padding: 10px;
    border-bottom:1px solid #fff;
    text-align:left;
}
table th {
    background: rgba(255,255,255,0.2);
}
</style>
</head>
<body>

<header>
<h1>Admin Dashboard</h1>
<button id="logout">Logout</button>
</header>

<table id="visitorTable">
<thead>
<tr>
<th>Appointment No</th>
<th>Visitor Name</th>
<th>DOB</th>
<th>Father's Name</th>
<th>Address</th>
<th>Country</th>
<th>Visit Date</th>
<th>Visit Time</th>
<th>Contact Number</th>
<th>Passport</th>
<th>Email</th>
<th>Timestamp</th>
</tr>
</thead>
<tbody>
<tr><td colspan="12" style="text-align:center;">Loading...</td></tr>
</tbody>
</table>

<script>
// Logout button
document.getElementById('logout').addEventListener('click', function(){
    window.location.href = "index.html";
});

// Fetch visitor data from Google Apps Script
fetch('https://script.google.com/macros/s/AKfycbyTMQV6WISmi1Qu7ULbruAO3Sq7AJ-xnqzMskOivqLNRPhAgM6EZxeZNUB6qKgpif4G/exec')
.then(res => res.json())
.then(data => {
    const tableBody = document.querySelector('#visitorTable tbody');
    tableBody.innerHTML = ''; // clear loading

    if(data.length === 0){
        tableBody.innerHTML = '<tr><td colspan="12" style="text-align:center;">No records found</td></tr>';
        return;
    }

    data.forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td>${row.apmtNo}</td>
            <td>${row.visitorName}</td>
            <td>${row.dob}</td>
            <td>${row.fatherName}</td>
            <td>${row.address}</td>
            <td>${row.country}</td>
            <td>${row.visitDate}</td>
            <td>${row.visitTime}</td>
            <td>${row.contactNumber}</td>
            <td>${row.passport}</td>
            <td>${row.email}</td>
            <td>${row.timestamp}</td>
        `;
        tableBody.appendChild(tr);
    });
})
.catch(err=>{
    console.error(err);
    document.querySelector('#visitorTable tbody').innerHTML='<tr><td colspan="12" style="text-align:center;color:red;">Error loading data</td></tr>';
});
</script>

</body>
</html>
